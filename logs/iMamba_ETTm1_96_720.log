Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_720', model='iMamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_720_iMamba_ETTm1_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5401103
	speed: 0.0215s/iter; left time: 224.6603s
	iters: 200, epoch: 1 | loss: 0.5762336
	speed: 0.0162s/iter; left time: 167.8493s
	iters: 300, epoch: 1 | loss: 0.5535678
	speed: 0.0158s/iter; left time: 161.6685s
	iters: 400, epoch: 1 | loss: 0.5266811
	speed: 0.0159s/iter; left time: 161.1836s
	iters: 500, epoch: 1 | loss: 0.5906631
	speed: 0.0148s/iter; left time: 148.5811s
	iters: 600, epoch: 1 | loss: 0.4865123
	speed: 0.0136s/iter; left time: 135.2024s
	iters: 700, epoch: 1 | loss: 0.4950438
	speed: 0.0123s/iter; left time: 120.8887s
	iters: 800, epoch: 1 | loss: 0.5271500
	speed: 0.0123s/iter; left time: 120.1424s
	iters: 900, epoch: 1 | loss: 0.4990075
	speed: 0.0123s/iter; left time: 118.9353s
	iters: 1000, epoch: 1 | loss: 0.4818510
	speed: 0.0123s/iter; left time: 117.8058s
Epoch: 1 cost time: 15.404424667358398
Epoch: 1, Steps: 1054 | Train Loss: 0.5458589 Vali Loss: 1.0128537 Test Loss: 0.5081392
Validation loss decreased (inf --> 1.012854).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.5284268
	speed: 0.3928s/iter; left time: 3687.2996s
	iters: 200, epoch: 2 | loss: 0.4256045
	speed: 0.0131s/iter; left time: 121.5812s
	iters: 300, epoch: 2 | loss: 0.4771123
	speed: 0.0139s/iter; left time: 128.1106s
	iters: 400, epoch: 2 | loss: 0.4736107
	speed: 0.0133s/iter; left time: 120.4031s
	iters: 500, epoch: 2 | loss: 0.4722244
	speed: 0.0127s/iter; left time: 113.8029s
	iters: 600, epoch: 2 | loss: 0.4080835
	speed: 0.0123s/iter; left time: 109.3228s
	iters: 700, epoch: 2 | loss: 0.4958766
	speed: 0.0123s/iter; left time: 107.9458s
	iters: 800, epoch: 2 | loss: 0.4701982
	speed: 0.0123s/iter; left time: 106.6879s
	iters: 900, epoch: 2 | loss: 0.4052327
	speed: 0.0127s/iter; left time: 109.3653s
	iters: 1000, epoch: 2 | loss: 0.5557439
	speed: 0.0131s/iter; left time: 111.0170s
Epoch: 2 cost time: 13.661341905593872
Epoch: 2, Steps: 1054 | Train Loss: 0.4797506 Vali Loss: 0.9857356 Test Loss: 0.4897186
Validation loss decreased (1.012854 --> 0.985736).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.3911840
	speed: 0.3733s/iter; left time: 3110.6288s
	iters: 200, epoch: 3 | loss: 0.5549999
	speed: 0.0113s/iter; left time: 93.4063s
	iters: 300, epoch: 3 | loss: 0.4439040
	speed: 0.0134s/iter; left time: 108.9295s
	iters: 400, epoch: 3 | loss: 0.4732496
	speed: 0.0114s/iter; left time: 91.3933s
	iters: 500, epoch: 3 | loss: 0.4836144
	speed: 0.0110s/iter; left time: 87.0736s
	iters: 600, epoch: 3 | loss: 0.4348449
	speed: 0.0110s/iter; left time: 86.2152s
	iters: 700, epoch: 3 | loss: 0.4092132
	speed: 0.0111s/iter; left time: 86.0890s
	iters: 800, epoch: 3 | loss: 0.5273664
	speed: 0.0110s/iter; left time: 83.7266s
	iters: 900, epoch: 3 | loss: 0.4502857
	speed: 0.0110s/iter; left time: 82.9513s
	iters: 1000, epoch: 3 | loss: 0.4732977
	speed: 0.0112s/iter; left time: 83.2039s
Epoch: 3 cost time: 12.282433986663818
Epoch: 3, Steps: 1054 | Train Loss: 0.4655025 Vali Loss: 0.9827495 Test Loss: 0.4872076
Validation loss decreased (0.985736 --> 0.982750).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.4643782
	speed: 0.4219s/iter; left time: 3070.8571s
	iters: 200, epoch: 4 | loss: 0.5497200
	speed: 0.0132s/iter; left time: 94.8984s
	iters: 300, epoch: 4 | loss: 0.4243869
	speed: 0.0124s/iter; left time: 88.0621s
	iters: 400, epoch: 4 | loss: 0.4277368
	speed: 0.0123s/iter; left time: 85.5372s
	iters: 500, epoch: 4 | loss: 0.4409792
	speed: 0.0122s/iter; left time: 84.2019s
	iters: 600, epoch: 4 | loss: 0.4871390
	speed: 0.0123s/iter; left time: 83.1086s
	iters: 700, epoch: 4 | loss: 0.4485474
	speed: 0.0123s/iter; left time: 82.3741s
	iters: 800, epoch: 4 | loss: 0.4787270
	speed: 0.0122s/iter; left time: 80.3909s
	iters: 900, epoch: 4 | loss: 0.4920682
	speed: 0.0123s/iter; left time: 79.4443s
	iters: 1000, epoch: 4 | loss: 0.4937920
	speed: 0.0123s/iter; left time: 78.3992s
Epoch: 4 cost time: 13.23862361907959
Epoch: 4, Steps: 1054 | Train Loss: 0.4610616 Vali Loss: 0.9784908 Test Loss: 0.4864290
Validation loss decreased (0.982750 --> 0.978491).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.4584125
	speed: 0.4120s/iter; left time: 2564.6040s
	iters: 200, epoch: 5 | loss: 0.4490730
	speed: 0.0123s/iter; left time: 75.5509s
	iters: 300, epoch: 5 | loss: 0.3536296
	speed: 0.0143s/iter; left time: 85.9818s
	iters: 400, epoch: 5 | loss: 0.4144237
	speed: 0.0126s/iter; left time: 74.8463s
	iters: 500, epoch: 5 | loss: 0.4265625
	speed: 0.0123s/iter; left time: 71.7793s
	iters: 600, epoch: 5 | loss: 0.5133881
	speed: 0.0123s/iter; left time: 70.6239s
	iters: 700, epoch: 5 | loss: 0.4695194
	speed: 0.0122s/iter; left time: 68.3445s
	iters: 800, epoch: 5 | loss: 0.4457159
	speed: 0.0123s/iter; left time: 68.0419s
	iters: 900, epoch: 5 | loss: 0.5098096
	speed: 0.0123s/iter; left time: 66.6826s
	iters: 1000, epoch: 5 | loss: 0.4350971
	speed: 0.0143s/iter; left time: 76.2591s
Epoch: 5 cost time: 13.732228994369507
Epoch: 5, Steps: 1054 | Train Loss: 0.4591374 Vali Loss: 0.9781918 Test Loss: 0.4869878
Validation loss decreased (0.978491 --> 0.978192).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.5408133
	speed: 0.4214s/iter; left time: 2179.0160s
	iters: 200, epoch: 6 | loss: 0.4400991
	speed: 0.0124s/iter; left time: 63.1107s
	iters: 300, epoch: 6 | loss: 0.4194098
	speed: 0.0123s/iter; left time: 61.0033s
	iters: 400, epoch: 6 | loss: 0.4559590
	speed: 0.0123s/iter; left time: 59.9358s
	iters: 500, epoch: 6 | loss: 0.5208933
	speed: 0.0123s/iter; left time: 58.6360s
	iters: 600, epoch: 6 | loss: 0.4840896
	speed: 0.0120s/iter; left time: 55.9231s
	iters: 700, epoch: 6 | loss: 0.3884015
	speed: 0.0118s/iter; left time: 53.8993s
	iters: 800, epoch: 6 | loss: 0.4326051
	speed: 0.0117s/iter; left time: 52.1281s
	iters: 900, epoch: 6 | loss: 0.4843143
	speed: 0.0117s/iter; left time: 51.1300s
	iters: 1000, epoch: 6 | loss: 0.4202643
	speed: 0.0116s/iter; left time: 49.5758s
Epoch: 6 cost time: 12.87765622138977
Epoch: 6, Steps: 1054 | Train Loss: 0.4580156 Vali Loss: 0.9772462 Test Loss: 0.4867267
Validation loss decreased (0.978192 --> 0.977246).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.4136167
	speed: 0.3963s/iter; left time: 1631.4747s
	iters: 200, epoch: 7 | loss: 0.5367475
	speed: 0.0123s/iter; left time: 49.5403s
	iters: 300, epoch: 7 | loss: 0.4073562
	speed: 0.0123s/iter; left time: 48.1007s
	iters: 400, epoch: 7 | loss: 0.4193152
	speed: 0.0138s/iter; left time: 52.6677s
	iters: 500, epoch: 7 | loss: 0.4497301
	speed: 0.0154s/iter; left time: 57.0749s
	iters: 600, epoch: 7 | loss: 0.4859192
	speed: 0.0142s/iter; left time: 51.4843s
	iters: 700, epoch: 7 | loss: 0.4459223
	speed: 0.0149s/iter; left time: 52.4683s
	iters: 800, epoch: 7 | loss: 0.4731282
	speed: 0.0160s/iter; left time: 54.6951s
	iters: 900, epoch: 7 | loss: 0.4092248
	speed: 0.0157s/iter; left time: 52.1682s
	iters: 1000, epoch: 7 | loss: 0.5118653
	speed: 0.0149s/iter; left time: 47.8273s
Epoch: 7 cost time: 15.159799337387085
Epoch: 7, Steps: 1054 | Train Loss: 0.4576644 Vali Loss: 0.9768823 Test Loss: 0.4865687
Validation loss decreased (0.977246 --> 0.976882).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.4050775
	speed: 0.4111s/iter; left time: 1259.0625s
	iters: 200, epoch: 8 | loss: 0.4196344
	speed: 0.0143s/iter; left time: 42.4240s
	iters: 300, epoch: 8 | loss: 0.4855778
	speed: 0.0127s/iter; left time: 36.3692s
	iters: 400, epoch: 8 | loss: 0.4079173
	speed: 0.0138s/iter; left time: 38.0467s
	iters: 500, epoch: 8 | loss: 0.3939781
	speed: 0.0167s/iter; left time: 44.4427s
	iters: 600, epoch: 8 | loss: 0.4299417
	speed: 0.0159s/iter; left time: 40.8221s
	iters: 700, epoch: 8 | loss: 0.4929672
	speed: 0.0142s/iter; left time: 35.0773s
	iters: 800, epoch: 8 | loss: 0.4504640
	speed: 0.0140s/iter; left time: 33.1805s
	iters: 900, epoch: 8 | loss: 0.4985723
	speed: 0.0129s/iter; left time: 29.2582s
	iters: 1000, epoch: 8 | loss: 0.4046210
	speed: 0.0122s/iter; left time: 26.4105s
Epoch: 8 cost time: 15.048285961151123
Epoch: 8, Steps: 1054 | Train Loss: 0.4575672 Vali Loss: 0.9770541 Test Loss: 0.4865387
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.4125611
	speed: 0.4176s/iter; left time: 838.9009s
	iters: 200, epoch: 9 | loss: 0.4226837
	speed: 0.0145s/iter; left time: 27.7032s
	iters: 300, epoch: 9 | loss: 0.4180838
	speed: 0.0177s/iter; left time: 31.9632s
	iters: 400, epoch: 9 | loss: 0.4439605
	speed: 0.0200s/iter; left time: 34.1499s
	iters: 500, epoch: 9 | loss: 0.4771053
	speed: 0.0194s/iter; left time: 31.2289s
	iters: 600, epoch: 9 | loss: 0.4133417
	speed: 0.0186s/iter; left time: 28.1241s
	iters: 700, epoch: 9 | loss: 0.4536119
	speed: 0.0182s/iter; left time: 25.6760s
	iters: 800, epoch: 9 | loss: 0.4222617
	speed: 0.0143s/iter; left time: 18.7272s
	iters: 900, epoch: 9 | loss: 0.4775586
	speed: 0.0156s/iter; left time: 18.8915s
	iters: 1000, epoch: 9 | loss: 0.4314154
	speed: 0.0147s/iter; left time: 16.3186s
Epoch: 9 cost time: 17.693933486938477
Epoch: 9, Steps: 1054 | Train Loss: 0.4573452 Vali Loss: 0.9769577 Test Loss: 0.4864944
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.4572878
	speed: 0.4915s/iter; left time: 469.3699s
	iters: 200, epoch: 10 | loss: 0.4063354
	speed: 0.0164s/iter; left time: 14.0071s
	iters: 300, epoch: 10 | loss: 0.4279918
	speed: 0.0149s/iter; left time: 11.2638s
	iters: 400, epoch: 10 | loss: 0.4967646
	speed: 0.0139s/iter; left time: 9.1102s
	iters: 500, epoch: 10 | loss: 0.4043331
	speed: 0.0141s/iter; left time: 7.8260s
	iters: 600, epoch: 10 | loss: 0.4602923
	speed: 0.0143s/iter; left time: 6.4940s
	iters: 700, epoch: 10 | loss: 0.4824411
	speed: 0.0151s/iter; left time: 5.3462s
	iters: 800, epoch: 10 | loss: 0.4378507
	speed: 0.0140s/iter; left time: 3.5822s
	iters: 900, epoch: 10 | loss: 0.5037559
	speed: 0.0154s/iter; left time: 2.3826s
	iters: 1000, epoch: 10 | loss: 0.3695216
	speed: 0.0153s/iter; left time: 0.8416s
Epoch: 10 cost time: 16.04516839981079
Epoch: 10, Steps: 1054 | Train Loss: 0.4572533 Vali Loss: 0.9768988 Test Loss: 0.4865195
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_720_iMamba_ETTm1_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4865685999393463, mae:0.45872458815574646

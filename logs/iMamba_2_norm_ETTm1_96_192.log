Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_192', model='iMamba_2', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_192_iMamba_2_ETTm1_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3929619
	speed: 0.0262s/iter; left time: 278.5030s
	iters: 200, epoch: 1 | loss: 0.4330344
	speed: 0.0156s/iter; left time: 164.2931s
	iters: 300, epoch: 1 | loss: 0.3931820
	speed: 0.0144s/iter; left time: 149.7313s
	iters: 400, epoch: 1 | loss: 0.3202328
	speed: 0.0160s/iter; left time: 164.9918s
	iters: 500, epoch: 1 | loss: 0.4619042
	speed: 0.0156s/iter; left time: 158.9166s
	iters: 600, epoch: 1 | loss: 0.2980622
	speed: 0.0162s/iter; left time: 164.0850s
	iters: 700, epoch: 1 | loss: 0.3522174
	speed: 0.0168s/iter; left time: 168.0306s
	iters: 800, epoch: 1 | loss: 0.3219728
	speed: 0.0153s/iter; left time: 151.9522s
	iters: 900, epoch: 1 | loss: 0.3714569
	speed: 0.0164s/iter; left time: 160.5397s
	iters: 1000, epoch: 1 | loss: 0.2875702
	speed: 0.0157s/iter; left time: 152.5983s
Epoch: 1 cost time: 18.142642736434937
Epoch: 1, Steps: 1071 | Train Loss: 0.3945813 Vali Loss: 0.5306300 Test Loss: 0.3828578
Validation loss decreased (inf --> 0.530630).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.3245675
	speed: 0.4713s/iter; left time: 4496.0084s
	iters: 200, epoch: 2 | loss: 0.3412189
	speed: 0.0160s/iter; left time: 151.4253s
	iters: 300, epoch: 2 | loss: 0.3095175
	speed: 0.0156s/iter; left time: 145.5817s
	iters: 400, epoch: 2 | loss: 0.2758379
	speed: 0.0151s/iter; left time: 139.5306s
	iters: 500, epoch: 2 | loss: 0.3571809
	speed: 0.0162s/iter; left time: 148.3626s
	iters: 600, epoch: 2 | loss: 0.2800486
	speed: 0.0146s/iter; left time: 131.5784s
	iters: 700, epoch: 2 | loss: 0.3190335
	speed: 0.0146s/iter; left time: 130.8800s
	iters: 800, epoch: 2 | loss: 0.3917703
	speed: 0.0149s/iter; left time: 132.0471s
	iters: 900, epoch: 2 | loss: 0.4190122
	speed: 0.0160s/iter; left time: 139.8540s
	iters: 1000, epoch: 2 | loss: 0.3244315
	speed: 0.0170s/iter; left time: 146.5091s
Epoch: 2 cost time: 16.984015941619873
Epoch: 2, Steps: 1071 | Train Loss: 0.3396885 Vali Loss: 0.5128061 Test Loss: 0.3692985
Validation loss decreased (0.530630 --> 0.512806).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.3157216
	speed: 0.4809s/iter; left time: 4072.8732s
	iters: 200, epoch: 3 | loss: 0.3160804
	speed: 0.0154s/iter; left time: 128.5767s
	iters: 300, epoch: 3 | loss: 0.3387882
	speed: 0.0146s/iter; left time: 121.0199s
	iters: 400, epoch: 3 | loss: 0.2563315
	speed: 0.0136s/iter; left time: 111.2267s
	iters: 500, epoch: 3 | loss: 0.3420004
	speed: 0.0133s/iter; left time: 107.2528s
	iters: 600, epoch: 3 | loss: 0.2888188
	speed: 0.0155s/iter; left time: 123.5872s
	iters: 700, epoch: 3 | loss: 0.3068110
	speed: 0.0149s/iter; left time: 117.1113s
	iters: 800, epoch: 3 | loss: 0.3296064
	speed: 0.0163s/iter; left time: 126.7082s
	iters: 900, epoch: 3 | loss: 0.3713830
	speed: 0.0169s/iter; left time: 129.6972s
	iters: 1000, epoch: 3 | loss: 0.3148295
	speed: 0.0155s/iter; left time: 117.2060s
Epoch: 3 cost time: 16.469809770584106
Epoch: 3, Steps: 1071 | Train Loss: 0.3279755 Vali Loss: 0.5085567 Test Loss: 0.3661736
Validation loss decreased (0.512806 --> 0.508557).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.3584820
	speed: 0.4733s/iter; left time: 3501.2003s
	iters: 200, epoch: 4 | loss: 0.3129492
	speed: 0.0162s/iter; left time: 118.1998s
	iters: 300, epoch: 4 | loss: 0.3283100
	speed: 0.0184s/iter; left time: 132.3409s
	iters: 400, epoch: 4 | loss: 0.2987059
	speed: 0.0184s/iter; left time: 130.7629s
	iters: 500, epoch: 4 | loss: 0.3566479
	speed: 0.0152s/iter; left time: 106.5461s
	iters: 600, epoch: 4 | loss: 0.4633244
	speed: 0.0146s/iter; left time: 100.7923s
	iters: 700, epoch: 4 | loss: 0.3343405
	speed: 0.0146s/iter; left time: 99.0865s
	iters: 800, epoch: 4 | loss: 0.3760450
	speed: 0.0146s/iter; left time: 97.6524s
	iters: 900, epoch: 4 | loss: 0.3217597
	speed: 0.0146s/iter; left time: 96.2539s
	iters: 1000, epoch: 4 | loss: 0.3956213
	speed: 0.0146s/iter; left time: 94.7077s
Epoch: 4 cost time: 16.97296404838562
Epoch: 4, Steps: 1071 | Train Loss: 0.3239302 Vali Loss: 0.5053629 Test Loss: 0.3664230
Validation loss decreased (0.508557 --> 0.505363).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.2913779
	speed: 0.4787s/iter; left time: 3028.5035s
	iters: 200, epoch: 5 | loss: 0.3300785
	speed: 0.0209s/iter; left time: 130.2221s
	iters: 300, epoch: 5 | loss: 0.3315909
	speed: 0.0219s/iter; left time: 134.3642s
	iters: 400, epoch: 5 | loss: 0.2725072
	speed: 0.0247s/iter; left time: 148.9773s
	iters: 500, epoch: 5 | loss: 0.3116515
	speed: 0.0211s/iter; left time: 125.1156s
	iters: 600, epoch: 5 | loss: 0.3277152
	speed: 0.0261s/iter; left time: 151.8077s
	iters: 700, epoch: 5 | loss: 0.2703495
	speed: 0.0327s/iter; left time: 187.2015s
	iters: 800, epoch: 5 | loss: 0.3602833
	speed: 0.0246s/iter; left time: 138.7050s
	iters: 900, epoch: 5 | loss: 0.2918934
	speed: 0.0139s/iter; left time: 76.8832s
	iters: 1000, epoch: 5 | loss: 0.3758412
	speed: 0.0143s/iter; left time: 77.5878s
Epoch: 5 cost time: 23.27739119529724
Epoch: 5, Steps: 1071 | Train Loss: 0.3220331 Vali Loss: 0.5052153 Test Loss: 0.3654234
Validation loss decreased (0.505363 --> 0.505215).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.2821526
	speed: 0.5075s/iter; left time: 2667.5395s
	iters: 200, epoch: 6 | loss: 0.2476790
	speed: 0.0144s/iter; left time: 74.4698s
	iters: 300, epoch: 6 | loss: 0.2782773
	speed: 0.0148s/iter; left time: 74.7568s
	iters: 400, epoch: 6 | loss: 0.3123984
	speed: 0.0161s/iter; left time: 79.5759s
	iters: 500, epoch: 6 | loss: 0.3161975
	speed: 0.0164s/iter; left time: 79.8165s
	iters: 600, epoch: 6 | loss: 0.3327246
	speed: 0.0144s/iter; left time: 68.4387s
	iters: 700, epoch: 6 | loss: 0.2698603
	speed: 0.0153s/iter; left time: 71.0507s
	iters: 800, epoch: 6 | loss: 0.3345311
	speed: 0.0169s/iter; left time: 76.8268s
	iters: 900, epoch: 6 | loss: 0.3776988
	speed: 0.0168s/iter; left time: 75.0669s
	iters: 1000, epoch: 6 | loss: 0.2527119
	speed: 0.0130s/iter; left time: 56.6192s
Epoch: 6 cost time: 16.50426483154297
Epoch: 6, Steps: 1071 | Train Loss: 0.3211134 Vali Loss: 0.5049716 Test Loss: 0.3655423
Validation loss decreased (0.505215 --> 0.504972).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.3357536
	speed: 0.5751s/iter; left time: 2406.6787s
	iters: 200, epoch: 7 | loss: 0.2977379
	speed: 0.0133s/iter; left time: 54.4267s
	iters: 300, epoch: 7 | loss: 0.2776749
	speed: 0.0131s/iter; left time: 52.2472s
	iters: 400, epoch: 7 | loss: 0.2923116
	speed: 0.0131s/iter; left time: 50.9730s
	iters: 500, epoch: 7 | loss: 0.3311679
	speed: 0.0132s/iter; left time: 49.8746s
	iters: 600, epoch: 7 | loss: 0.3100366
	speed: 0.0135s/iter; left time: 49.8310s
	iters: 700, epoch: 7 | loss: 0.2760543
	speed: 0.0181s/iter; left time: 64.7345s
	iters: 800, epoch: 7 | loss: 0.2918869
	speed: 0.0168s/iter; left time: 58.6347s
	iters: 900, epoch: 7 | loss: 0.4100839
	speed: 0.0168s/iter; left time: 56.7629s
	iters: 1000, epoch: 7 | loss: 0.2750182
	speed: 0.0164s/iter; left time: 54.0053s
Epoch: 7 cost time: 16.762584924697876
Epoch: 7, Steps: 1071 | Train Loss: 0.3208411 Vali Loss: 0.5048027 Test Loss: 0.3653430
Validation loss decreased (0.504972 --> 0.504803).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.2385159
	speed: 0.4843s/iter; left time: 1508.1401s
	iters: 200, epoch: 8 | loss: 0.2983164
	speed: 0.0137s/iter; left time: 41.2486s
	iters: 300, epoch: 8 | loss: 0.3299882
	speed: 0.0148s/iter; left time: 43.0978s
	iters: 400, epoch: 8 | loss: 0.3113717
	speed: 0.0144s/iter; left time: 40.5675s
	iters: 500, epoch: 8 | loss: 0.2523634
	speed: 0.0129s/iter; left time: 34.9522s
	iters: 600, epoch: 8 | loss: 0.2698859
	speed: 0.0129s/iter; left time: 33.6276s
	iters: 700, epoch: 8 | loss: 0.2758886
	speed: 0.0129s/iter; left time: 32.4149s
	iters: 800, epoch: 8 | loss: 0.3203354
	speed: 0.0129s/iter; left time: 31.0614s
	iters: 900, epoch: 8 | loss: 0.3997204
	speed: 0.0141s/iter; left time: 32.5367s
	iters: 1000, epoch: 8 | loss: 0.2828884
	speed: 0.0144s/iter; left time: 31.8270s
Epoch: 8 cost time: 15.261014223098755
Epoch: 8, Steps: 1071 | Train Loss: 0.3204107 Vali Loss: 0.5047826 Test Loss: 0.3652115
Validation loss decreased (0.504803 --> 0.504783).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.2917182
	speed: 0.4790s/iter; left time: 978.6439s
	iters: 200, epoch: 9 | loss: 0.3038982
	speed: 0.0191s/iter; left time: 37.0464s
	iters: 300, epoch: 9 | loss: 0.3159902
	speed: 0.0194s/iter; left time: 35.7447s
	iters: 400, epoch: 9 | loss: 0.4050490
	speed: 0.0169s/iter; left time: 29.3782s
	iters: 500, epoch: 9 | loss: 0.3084983
	speed: 0.0176s/iter; left time: 28.9725s
	iters: 600, epoch: 9 | loss: 0.3256580
	speed: 0.0146s/iter; left time: 22.4867s
	iters: 700, epoch: 9 | loss: 0.2786144
	speed: 0.0147s/iter; left time: 21.1834s
	iters: 800, epoch: 9 | loss: 0.3722341
	speed: 0.0158s/iter; left time: 21.2150s
	iters: 900, epoch: 9 | loss: 0.2764607
	speed: 0.0163s/iter; left time: 20.3024s
	iters: 1000, epoch: 9 | loss: 0.2803065
	speed: 0.0153s/iter; left time: 17.5247s
Epoch: 9 cost time: 17.803670644760132
Epoch: 9, Steps: 1071 | Train Loss: 0.3204299 Vali Loss: 0.5047949 Test Loss: 0.3651828
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.2666830
	speed: 0.4760s/iter; left time: 462.6265s
	iters: 200, epoch: 10 | loss: 0.2819564
	speed: 0.0177s/iter; left time: 15.4380s
	iters: 300, epoch: 10 | loss: 0.3320034
	speed: 0.0164s/iter; left time: 12.6849s
	iters: 400, epoch: 10 | loss: 0.3939651
	speed: 0.0172s/iter; left time: 11.5821s
	iters: 500, epoch: 10 | loss: 0.4004053
	speed: 0.0168s/iter; left time: 9.5881s
	iters: 600, epoch: 10 | loss: 0.2761497
	speed: 0.0141s/iter; left time: 6.6632s
	iters: 700, epoch: 10 | loss: 0.3001556
	speed: 0.0129s/iter; left time: 4.7813s
	iters: 800, epoch: 10 | loss: 0.3111788
	speed: 0.0164s/iter; left time: 4.4672s
	iters: 900, epoch: 10 | loss: 0.4280890
	speed: 0.0240s/iter; left time: 4.1234s
	iters: 1000, epoch: 10 | loss: 0.3075533
	speed: 0.0253s/iter; left time: 1.8204s
Epoch: 10 cost time: 19.8403959274292
Epoch: 10, Steps: 1071 | Train Loss: 0.3204522 Vali Loss: 0.5047677 Test Loss: 0.3651861
Validation loss decreased (0.504783 --> 0.504768).  Saving model ...
Updating learning rate to 9.765625e-08
>>>>>>>testing : ETTm1_96_192_iMamba_2_ETTm1_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 1, 192, 7) (11329, 1, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.3651859760284424, mae:0.38451072573661804

Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_192', model='S_Mamba', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_192_S_Mamba_ETTm2_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3012602
	speed: 0.0255s/iter; left time: 270.4907s
	iters: 200, epoch: 1 | loss: 0.4995536
	speed: 0.0199s/iter; left time: 208.7853s
	iters: 300, epoch: 1 | loss: 0.3379359
	speed: 0.0194s/iter; left time: 202.0511s
	iters: 400, epoch: 1 | loss: 0.3334073
	speed: 0.0186s/iter; left time: 191.6720s
	iters: 500, epoch: 1 | loss: 0.1690861
	speed: 0.0225s/iter; left time: 229.7046s
	iters: 600, epoch: 1 | loss: 0.3512918
	speed: 0.0271s/iter; left time: 273.6520s
	iters: 700, epoch: 1 | loss: 0.2285203
	speed: 0.0251s/iter; left time: 251.4431s
	iters: 800, epoch: 1 | loss: 0.2111770
	speed: 0.0254s/iter; left time: 251.3532s
	iters: 900, epoch: 1 | loss: 0.6716039
	speed: 0.0248s/iter; left time: 243.7482s
	iters: 1000, epoch: 1 | loss: 0.2133121
	speed: 0.0248s/iter; left time: 241.2530s
Epoch: 1 cost time: 25.11063289642334
Epoch: 1, Steps: 1071 | Train Loss: 0.3582397 Vali Loss: 0.1788308 Test Loss: 0.2524294
Validation loss decreased (inf --> 0.178831).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.1588335
	speed: 0.5356s/iter; left time: 5109.6331s
	iters: 200, epoch: 2 | loss: 0.5429298
	speed: 0.0236s/iter; left time: 222.6836s
	iters: 300, epoch: 2 | loss: 0.2436200
	speed: 0.0191s/iter; left time: 178.6226s
	iters: 400, epoch: 2 | loss: 0.6661969
	speed: 0.0189s/iter; left time: 174.5157s
	iters: 500, epoch: 2 | loss: 0.1978594
	speed: 0.0188s/iter; left time: 171.9576s
	iters: 600, epoch: 2 | loss: 0.2225192
	speed: 0.0185s/iter; left time: 167.1971s
	iters: 700, epoch: 2 | loss: 0.3047665
	speed: 0.0185s/iter; left time: 165.6637s
	iters: 800, epoch: 2 | loss: 0.1797348
	speed: 0.0186s/iter; left time: 164.8390s
	iters: 900, epoch: 2 | loss: 0.2246650
	speed: 0.0217s/iter; left time: 190.0188s
	iters: 1000, epoch: 2 | loss: 0.3138861
	speed: 0.0210s/iter; left time: 181.5559s
Epoch: 2 cost time: 21.788862705230713
Epoch: 2, Steps: 1071 | Train Loss: 0.3321302 Vali Loss: 0.1793149 Test Loss: 0.2512068
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.2344782
	speed: 0.5146s/iter; left time: 4357.8142s
	iters: 200, epoch: 3 | loss: 0.3400995
	speed: 0.0240s/iter; left time: 201.0989s
	iters: 300, epoch: 3 | loss: 0.2869393
	speed: 0.0244s/iter; left time: 201.4983s
	iters: 400, epoch: 3 | loss: 0.2520988
	speed: 0.0212s/iter; left time: 173.0893s
	iters: 500, epoch: 3 | loss: 0.3365357
	speed: 0.0213s/iter; left time: 171.7140s
	iters: 600, epoch: 3 | loss: 0.5178004
	speed: 0.0234s/iter; left time: 186.5154s
	iters: 700, epoch: 3 | loss: 0.2311891
	speed: 0.0226s/iter; left time: 177.9967s
	iters: 800, epoch: 3 | loss: 0.2535133
	speed: 0.0212s/iter; left time: 164.7601s
	iters: 900, epoch: 3 | loss: 0.3524692
	speed: 0.0212s/iter; left time: 162.8149s
	iters: 1000, epoch: 3 | loss: 0.1599706
	speed: 0.0221s/iter; left time: 166.9899s
Epoch: 3 cost time: 24.30460214614868
Epoch: 3, Steps: 1071 | Train Loss: 0.3213178 Vali Loss: 0.1801385 Test Loss: 0.2507739
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.2903743
	speed: 0.5201s/iter; left time: 3847.3849s
	iters: 200, epoch: 4 | loss: 0.2472575
	speed: 0.0288s/iter; left time: 210.4024s
	iters: 300, epoch: 4 | loss: 0.2264385
	speed: 0.0287s/iter; left time: 206.2286s
	iters: 400, epoch: 4 | loss: 0.2640770
	speed: 0.0289s/iter; left time: 204.9668s
	iters: 500, epoch: 4 | loss: 0.1687956
	speed: 0.0288s/iter; left time: 201.3746s
	iters: 600, epoch: 4 | loss: 0.3137792
	speed: 0.0222s/iter; left time: 153.4702s
	iters: 700, epoch: 4 | loss: 0.3979891
	speed: 0.0200s/iter; left time: 135.7594s
	iters: 800, epoch: 4 | loss: 0.1498162
	speed: 0.0200s/iter; left time: 133.9395s
	iters: 900, epoch: 4 | loss: 0.4026590
	speed: 0.0201s/iter; left time: 132.3301s
	iters: 1000, epoch: 4 | loss: 0.2591897
	speed: 0.0211s/iter; left time: 137.1816s
Epoch: 4 cost time: 26.02795648574829
Epoch: 4, Steps: 1071 | Train Loss: 0.3158184 Vali Loss: 0.1798179 Test Loss: 0.2503798
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_192_S_Mamba_ETTm2_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 1, 192, 7) (11329, 1, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.25242918729782104, mae:0.3126223683357239

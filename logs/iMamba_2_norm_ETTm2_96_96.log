Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_96', model='iMamba_2', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, enc_in=7, dec_in=7, c_out=7, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_96_iMamba_2_ETTm2_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.6358464
	speed: 0.0245s/iter; left time: 260.8773s
	iters: 200, epoch: 1 | loss: 0.3126255
	speed: 0.0148s/iter; left time: 156.4456s
	iters: 300, epoch: 1 | loss: 0.2255599
	speed: 0.0122s/iter; left time: 127.7455s
	iters: 400, epoch: 1 | loss: 0.5204459
	speed: 0.0127s/iter; left time: 131.2085s
	iters: 500, epoch: 1 | loss: 0.2169261
	speed: 0.0150s/iter; left time: 153.5640s
	iters: 600, epoch: 1 | loss: 0.1957742
	speed: 0.0132s/iter; left time: 133.7535s
	iters: 700, epoch: 1 | loss: 0.1915624
	speed: 0.0133s/iter; left time: 133.6835s
	iters: 800, epoch: 1 | loss: 0.2336330
	speed: 0.0157s/iter; left time: 155.7157s
	iters: 900, epoch: 1 | loss: 0.2161431
	speed: 0.0133s/iter; left time: 130.6577s
	iters: 1000, epoch: 1 | loss: 0.1368875
	speed: 0.0132s/iter; left time: 128.4942s
Epoch: 1 cost time: 15.78747844696045
Epoch: 1, Steps: 1074 | Train Loss: 0.2450749 Vali Loss: 0.1294833 Test Loss: 0.1801130
Validation loss decreased (inf --> 0.129483).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.2769988
	speed: 0.5022s/iter; left time: 4804.3335s
	iters: 200, epoch: 2 | loss: 0.3298796
	speed: 0.0143s/iter; left time: 135.6515s
	iters: 300, epoch: 2 | loss: 0.2579578
	speed: 0.0135s/iter; left time: 126.4766s
	iters: 400, epoch: 2 | loss: 0.1575391
	speed: 0.0137s/iter; left time: 127.2034s
	iters: 500, epoch: 2 | loss: 0.1234275
	speed: 0.0141s/iter; left time: 129.4477s
	iters: 600, epoch: 2 | loss: 0.3923064
	speed: 0.0161s/iter; left time: 145.7471s
	iters: 700, epoch: 2 | loss: 0.4233170
	speed: 0.0162s/iter; left time: 145.1525s
	iters: 800, epoch: 2 | loss: 0.2319135
	speed: 0.0166s/iter; left time: 146.8425s
	iters: 900, epoch: 2 | loss: 0.1380730
	speed: 0.0167s/iter; left time: 146.0538s
	iters: 1000, epoch: 2 | loss: 0.2546068
	speed: 0.0149s/iter; left time: 129.0670s
Epoch: 2 cost time: 16.54334783554077
Epoch: 2, Steps: 1074 | Train Loss: 0.2175351 Vali Loss: 0.1295218 Test Loss: 0.1798651
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.1679930
	speed: 0.4684s/iter; left time: 3977.7344s
	iters: 200, epoch: 3 | loss: 0.0988163
	speed: 0.0147s/iter; left time: 123.2680s
	iters: 300, epoch: 3 | loss: 0.4027522
	speed: 0.0149s/iter; left time: 123.3112s
	iters: 400, epoch: 3 | loss: 0.1565033
	speed: 0.0143s/iter; left time: 116.9834s
	iters: 500, epoch: 3 | loss: 0.1169474
	speed: 0.0152s/iter; left time: 123.1066s
	iters: 600, epoch: 3 | loss: 0.1588362
	speed: 0.0168s/iter; left time: 133.8890s
	iters: 700, epoch: 3 | loss: 0.1818960
	speed: 0.0161s/iter; left time: 126.7279s
	iters: 800, epoch: 3 | loss: 0.2730028
	speed: 0.0149s/iter; left time: 116.0664s
	iters: 900, epoch: 3 | loss: 0.1963656
	speed: 0.0158s/iter; left time: 121.4662s
	iters: 1000, epoch: 3 | loss: 0.1422853
	speed: 0.0148s/iter; left time: 112.6977s
Epoch: 3 cost time: 16.571519136428833
Epoch: 3, Steps: 1074 | Train Loss: 0.2065964 Vali Loss: 0.1306906 Test Loss: 0.1806051
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.3062693
	speed: 0.4988s/iter; left time: 3700.5002s
	iters: 200, epoch: 4 | loss: 0.1633652
	speed: 0.0161s/iter; left time: 117.7515s
	iters: 300, epoch: 4 | loss: 0.1657224
	speed: 0.0170s/iter; left time: 122.4113s
	iters: 400, epoch: 4 | loss: 0.1064920
	speed: 0.0158s/iter; left time: 112.8332s
	iters: 500, epoch: 4 | loss: 0.2735311
	speed: 0.0166s/iter; left time: 116.3912s
	iters: 600, epoch: 4 | loss: 0.1768310
	speed: 0.0167s/iter; left time: 115.7581s
	iters: 700, epoch: 4 | loss: 0.1817379
	speed: 0.0175s/iter; left time: 119.1165s
	iters: 800, epoch: 4 | loss: 0.1720204
	speed: 0.0180s/iter; left time: 120.6784s
	iters: 900, epoch: 4 | loss: 0.1132351
	speed: 0.0173s/iter; left time: 114.3550s
	iters: 1000, epoch: 4 | loss: 0.1940304
	speed: 0.0142s/iter; left time: 92.6839s
Epoch: 4 cost time: 17.584594249725342
Epoch: 4, Steps: 1074 | Train Loss: 0.2013942 Vali Loss: 0.1324930 Test Loss: 0.1821262
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_96_iMamba_2_ETTm2_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.18011298775672913, mae:0.26397940516471863

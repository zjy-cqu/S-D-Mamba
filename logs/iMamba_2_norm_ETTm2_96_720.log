Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_720', model='iMamba_2', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_720_iMamba_2_ETTm2_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5209102
	speed: 0.0217s/iter; left time: 226.9472s
	iters: 200, epoch: 1 | loss: 0.8709579
	speed: 0.0146s/iter; left time: 150.9994s
	iters: 300, epoch: 1 | loss: 0.5614454
	speed: 0.0146s/iter; left time: 149.1376s
	iters: 400, epoch: 1 | loss: 0.8421798
	speed: 0.0150s/iter; left time: 151.7781s
	iters: 500, epoch: 1 | loss: 0.6510631
	speed: 0.0147s/iter; left time: 147.2352s
	iters: 600, epoch: 1 | loss: 0.3758947
	speed: 0.0147s/iter; left time: 146.1997s
	iters: 700, epoch: 1 | loss: 0.9598187
	speed: 0.0147s/iter; left time: 144.2231s
	iters: 800, epoch: 1 | loss: 0.6561317
	speed: 0.0147s/iter; left time: 143.4396s
	iters: 900, epoch: 1 | loss: 0.4437295
	speed: 0.0144s/iter; left time: 138.8914s
	iters: 1000, epoch: 1 | loss: 0.5276005
	speed: 0.0144s/iter; left time: 137.5887s
Epoch: 1 cost time: 16.141013383865356
Epoch: 1, Steps: 1054 | Train Loss: 0.6064150 Vali Loss: 0.2962317 Test Loss: 0.4119784
Validation loss decreased (inf --> 0.296232).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.3214864
	speed: 0.4522s/iter; left time: 4244.7679s
	iters: 200, epoch: 2 | loss: 0.6912782
	speed: 0.0129s/iter; left time: 119.9877s
	iters: 300, epoch: 2 | loss: 0.5739435
	speed: 0.0141s/iter; left time: 129.7688s
	iters: 400, epoch: 2 | loss: 0.8332296
	speed: 0.0142s/iter; left time: 128.8291s
	iters: 500, epoch: 2 | loss: 0.5051511
	speed: 0.0139s/iter; left time: 125.0228s
	iters: 600, epoch: 2 | loss: 0.2941386
	speed: 0.0151s/iter; left time: 134.5006s
	iters: 700, epoch: 2 | loss: 0.5561493
	speed: 0.0151s/iter; left time: 132.4884s
	iters: 800, epoch: 2 | loss: 0.5356783
	speed: 0.0140s/iter; left time: 121.9391s
	iters: 900, epoch: 2 | loss: 0.3806321
	speed: 0.0131s/iter; left time: 112.6570s
	iters: 1000, epoch: 2 | loss: 0.5692666
	speed: 0.0131s/iter; left time: 111.5065s
Epoch: 2 cost time: 14.869905948638916
Epoch: 2, Steps: 1054 | Train Loss: 0.5763975 Vali Loss: 0.2988963 Test Loss: 0.4062906
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.5309513
	speed: 0.4300s/iter; left time: 3583.3102s
	iters: 200, epoch: 3 | loss: 0.4700935
	speed: 0.0148s/iter; left time: 122.1782s
	iters: 300, epoch: 3 | loss: 0.6426000
	speed: 0.0135s/iter; left time: 109.7455s
	iters: 400, epoch: 3 | loss: 0.6894777
	speed: 0.0139s/iter; left time: 111.8315s
	iters: 500, epoch: 3 | loss: 0.2801996
	speed: 0.0142s/iter; left time: 112.5910s
	iters: 600, epoch: 3 | loss: 0.5870459
	speed: 0.0149s/iter; left time: 116.5045s
	iters: 700, epoch: 3 | loss: 0.3503835
	speed: 0.0148s/iter; left time: 114.1481s
	iters: 800, epoch: 3 | loss: 0.3456115
	speed: 0.0144s/iter; left time: 109.5762s
	iters: 900, epoch: 3 | loss: 0.4599764
	speed: 0.0148s/iter; left time: 111.8151s
	iters: 1000, epoch: 3 | loss: 0.6251868
	speed: 0.0144s/iter; left time: 106.8880s
Epoch: 3 cost time: 15.568220376968384
Epoch: 3, Steps: 1054 | Train Loss: 0.5633820 Vali Loss: 0.2968160 Test Loss: 0.4054060
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.4700058
	speed: 0.4689s/iter; left time: 3412.8730s
	iters: 200, epoch: 4 | loss: 0.8882754
	speed: 0.0173s/iter; left time: 124.4844s
	iters: 300, epoch: 4 | loss: 0.5427272
	speed: 0.0137s/iter; left time: 96.8221s
	iters: 400, epoch: 4 | loss: 0.6261128
	speed: 0.0129s/iter; left time: 89.7544s
	iters: 500, epoch: 4 | loss: 0.7369185
	speed: 0.0138s/iter; left time: 94.7592s
	iters: 600, epoch: 4 | loss: 0.8306040
	speed: 0.0161s/iter; left time: 108.8207s
	iters: 700, epoch: 4 | loss: 0.4042227
	speed: 0.0160s/iter; left time: 106.8173s
	iters: 800, epoch: 4 | loss: 0.3880982
	speed: 0.0137s/iter; left time: 90.4167s
	iters: 900, epoch: 4 | loss: 0.4978302
	speed: 0.0148s/iter; left time: 95.6108s
	iters: 1000, epoch: 4 | loss: 0.3632514
	speed: 0.0136s/iter; left time: 86.6657s
Epoch: 4 cost time: 15.91633677482605
Epoch: 4, Steps: 1054 | Train Loss: 0.5576041 Vali Loss: 0.2988800 Test Loss: 0.4062881
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_720_iMamba_2_ETTm2_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.411978542804718, mae:0.40485429763793945

Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_336', model='iMamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_336_iMamba_ETTm1_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4830787
	speed: 0.0267s/iter; left time: 281.5113s
	iters: 200, epoch: 1 | loss: 0.4936035
	speed: 0.0198s/iter; left time: 207.2734s
	iters: 300, epoch: 1 | loss: 0.4367693
	speed: 0.0166s/iter; left time: 172.4019s
	iters: 400, epoch: 1 | loss: 0.4559190
	speed: 0.0159s/iter; left time: 163.2377s
	iters: 500, epoch: 1 | loss: 0.4394462
	speed: 0.0164s/iter; left time: 166.3623s
	iters: 600, epoch: 1 | loss: 0.5109053
	speed: 0.0227s/iter; left time: 227.9701s
	iters: 700, epoch: 1 | loss: 0.4681835
	speed: 0.0214s/iter; left time: 213.2185s
	iters: 800, epoch: 1 | loss: 0.4918060
	speed: 0.0228s/iter; left time: 225.1307s
	iters: 900, epoch: 1 | loss: 0.4330559
	speed: 0.0226s/iter; left time: 220.5861s
	iters: 1000, epoch: 1 | loss: 0.3833804
	speed: 0.0224s/iter; left time: 216.5942s
Epoch: 1 cost time: 22.225075244903564
Epoch: 1, Steps: 1066 | Train Loss: 0.4794076 Vali Loss: 0.7000881 Test Loss: 0.4432727
Validation loss decreased (inf --> 0.700088).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.4302446
	speed: 1.6143s/iter; left time: 15328.0177s
	iters: 200, epoch: 2 | loss: 0.3818941
	speed: 0.0186s/iter; left time: 174.7456s
	iters: 300, epoch: 2 | loss: 0.4741294
	speed: 0.0190s/iter; left time: 176.3859s
	iters: 400, epoch: 2 | loss: 0.3962707
	speed: 0.0174s/iter; left time: 159.6062s
	iters: 500, epoch: 2 | loss: 0.4651496
	speed: 0.0158s/iter; left time: 144.0245s
	iters: 600, epoch: 2 | loss: 0.4481436
	speed: 0.0159s/iter; left time: 143.3315s
	iters: 700, epoch: 2 | loss: 0.4340867
	speed: 0.0167s/iter; left time: 148.2543s
	iters: 800, epoch: 2 | loss: 0.3758399
	speed: 0.0159s/iter; left time: 139.4560s
	iters: 900, epoch: 2 | loss: 0.5233943
	speed: 0.0183s/iter; left time: 159.4286s
	iters: 1000, epoch: 2 | loss: 0.3690774
	speed: 0.0180s/iter; left time: 154.4257s
Epoch: 2 cost time: 19.14900541305542
Epoch: 2, Steps: 1066 | Train Loss: 0.4115730 Vali Loss: 0.6736259 Test Loss: 0.4197755
Validation loss decreased (0.700088 --> 0.673626).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.4022870
	speed: 1.5456s/iter; left time: 13028.0026s
	iters: 200, epoch: 3 | loss: 0.3753894
	speed: 0.0307s/iter; left time: 256.0235s
	iters: 300, epoch: 3 | loss: 0.4121980
	speed: 0.0329s/iter; left time: 270.3310s
	iters: 400, epoch: 3 | loss: 0.3671739
	speed: 0.0463s/iter; left time: 376.1926s
	iters: 500, epoch: 3 | loss: 0.4413055
	speed: 0.0314s/iter; left time: 252.2890s
	iters: 600, epoch: 3 | loss: 0.4132659
	speed: 0.0257s/iter; left time: 204.0628s
	iters: 700, epoch: 3 | loss: 0.4383487
	speed: 0.0231s/iter; left time: 180.9802s
	iters: 800, epoch: 3 | loss: 0.4146445
	speed: 0.0167s/iter; left time: 129.3905s
	iters: 900, epoch: 3 | loss: 0.2997859
	speed: 0.0180s/iter; left time: 137.2423s
	iters: 1000, epoch: 3 | loss: 0.4186833
	speed: 0.0241s/iter; left time: 181.4468s
Epoch: 3 cost time: 28.878355503082275
Epoch: 3, Steps: 1066 | Train Loss: 0.3983462 Vali Loss: 0.6690425 Test Loss: 0.4141588
Validation loss decreased (0.673626 --> 0.669042).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.3844621
	speed: 1.5654s/iter; left time: 11525.9646s
	iters: 200, epoch: 4 | loss: 0.3846965
	speed: 0.0168s/iter; left time: 121.6637s
	iters: 300, epoch: 4 | loss: 0.3146353
	speed: 0.0170s/iter; left time: 121.6640s
	iters: 400, epoch: 4 | loss: 0.4106297
	speed: 0.0189s/iter; left time: 133.6058s
	iters: 500, epoch: 4 | loss: 0.2951279
	speed: 0.0167s/iter; left time: 116.3680s
	iters: 600, epoch: 4 | loss: 0.3188716
	speed: 0.0166s/iter; left time: 113.8216s
	iters: 700, epoch: 4 | loss: 0.5042981
	speed: 0.0186s/iter; left time: 125.6035s
	iters: 800, epoch: 4 | loss: 0.3791739
	speed: 0.0165s/iter; left time: 109.9833s
	iters: 900, epoch: 4 | loss: 0.3544347
	speed: 0.0168s/iter; left time: 110.1249s
	iters: 1000, epoch: 4 | loss: 0.3705553
	speed: 0.0165s/iter; left time: 106.3210s
Epoch: 4 cost time: 18.384380102157593
Epoch: 4, Steps: 1066 | Train Loss: 0.3939320 Vali Loss: 0.6653479 Test Loss: 0.4129394
Validation loss decreased (0.669042 --> 0.665348).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.3932445
	speed: 1.5729s/iter; left time: 9904.4153s
	iters: 200, epoch: 5 | loss: 0.3769773
	speed: 0.0186s/iter; left time: 115.0832s
	iters: 300, epoch: 5 | loss: 0.3967405
	speed: 0.0188s/iter; left time: 114.5246s
	iters: 400, epoch: 5 | loss: 0.3305483
	speed: 0.0170s/iter; left time: 101.8284s
	iters: 500, epoch: 5 | loss: 0.4008099
	speed: 0.0175s/iter; left time: 103.3142s
	iters: 600, epoch: 5 | loss: 0.4085757
	speed: 0.0175s/iter; left time: 101.6459s
	iters: 700, epoch: 5 | loss: 0.4382155
	speed: 0.0184s/iter; left time: 104.6577s
	iters: 800, epoch: 5 | loss: 0.4110762
	speed: 0.0230s/iter; left time: 128.8036s
	iters: 900, epoch: 5 | loss: 0.4668690
	speed: 0.0187s/iter; left time: 102.6148s
	iters: 1000, epoch: 5 | loss: 0.3901696
	speed: 0.0169s/iter; left time: 91.3508s
Epoch: 5 cost time: 20.012494802474976
Epoch: 5, Steps: 1066 | Train Loss: 0.3919663 Vali Loss: 0.6659163 Test Loss: 0.4119577
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.3373970
	speed: 1.6022s/iter; left time: 8380.9153s
	iters: 200, epoch: 6 | loss: 0.3903213
	speed: 0.0302s/iter; left time: 155.1621s
	iters: 300, epoch: 6 | loss: 0.3891747
	speed: 0.0174s/iter; left time: 87.4686s
	iters: 400, epoch: 6 | loss: 0.3880883
	speed: 0.0188s/iter; left time: 92.8521s
	iters: 500, epoch: 6 | loss: 0.3725544
	speed: 0.0160s/iter; left time: 77.5109s
	iters: 600, epoch: 6 | loss: 0.4001024
	speed: 0.0159s/iter; left time: 75.2501s
	iters: 700, epoch: 6 | loss: 0.4314190
	speed: 0.0175s/iter; left time: 81.1622s
	iters: 800, epoch: 6 | loss: 0.3357717
	speed: 0.0159s/iter; left time: 72.1803s
	iters: 900, epoch: 6 | loss: 0.4043341
	speed: 0.0164s/iter; left time: 72.6667s
	iters: 1000, epoch: 6 | loss: 0.4201336
	speed: 0.0169s/iter; left time: 73.3916s
Epoch: 6 cost time: 22.24050807952881
Epoch: 6, Steps: 1066 | Train Loss: 0.3912218 Vali Loss: 0.6654828 Test Loss: 0.4115108
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.3659350
	speed: 1.5901s/iter; left time: 6622.7284s
	iters: 200, epoch: 7 | loss: 0.3418454
	speed: 0.0321s/iter; left time: 130.4480s
	iters: 300, epoch: 7 | loss: 0.4105363
	speed: 0.0306s/iter; left time: 121.2280s
	iters: 400, epoch: 7 | loss: 0.4518287
	speed: 0.0404s/iter; left time: 156.1599s
	iters: 500, epoch: 7 | loss: 0.3793948
	speed: 0.0382s/iter; left time: 143.7588s
	iters: 600, epoch: 7 | loss: 0.4059096
	speed: 0.0176s/iter; left time: 64.6061s
	iters: 700, epoch: 7 | loss: 0.4072789
	speed: 0.0204s/iter; left time: 72.6138s
	iters: 800, epoch: 7 | loss: 0.3320900
	speed: 0.0165s/iter; left time: 57.1838s
	iters: 900, epoch: 7 | loss: 0.3578283
	speed: 0.0164s/iter; left time: 55.3170s
	iters: 1000, epoch: 7 | loss: 0.3647704
	speed: 0.0217s/iter; left time: 70.8165s
Epoch: 7 cost time: 27.847033977508545
Epoch: 7, Steps: 1066 | Train Loss: 0.3907087 Vali Loss: 0.6644514 Test Loss: 0.4114074
Validation loss decreased (0.665348 --> 0.664451).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.4483615
	speed: 1.5672s/iter; left time: 4856.8057s
	iters: 200, epoch: 8 | loss: 0.3990388
	speed: 0.0179s/iter; left time: 53.5783s
	iters: 300, epoch: 8 | loss: 0.4532360
	speed: 0.0229s/iter; left time: 66.2924s
	iters: 400, epoch: 8 | loss: 0.3496753
	speed: 0.0171s/iter; left time: 47.9707s
	iters: 500, epoch: 8 | loss: 0.4933307
	speed: 0.0163s/iter; left time: 43.9863s
	iters: 600, epoch: 8 | loss: 0.3349137
	speed: 0.0163s/iter; left time: 42.3548s
	iters: 700, epoch: 8 | loss: 0.4531525
	speed: 0.0165s/iter; left time: 41.3206s
	iters: 800, epoch: 8 | loss: 0.3671416
	speed: 0.0165s/iter; left time: 39.5677s
	iters: 900, epoch: 8 | loss: 0.3639918
	speed: 0.0163s/iter; left time: 37.5163s
	iters: 1000, epoch: 8 | loss: 0.4666613
	speed: 0.0183s/iter; left time: 40.2272s
Epoch: 8 cost time: 18.75269842147827
Epoch: 8, Steps: 1066 | Train Loss: 0.3905369 Vali Loss: 0.6647598 Test Loss: 0.4113249
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.3562580
	speed: 1.6280s/iter; left time: 3309.8178s
	iters: 200, epoch: 9 | loss: 0.4163593
	speed: 0.0210s/iter; left time: 40.5079s
	iters: 300, epoch: 9 | loss: 0.3633059
	speed: 0.0230s/iter; left time: 42.1637s
	iters: 400, epoch: 9 | loss: 0.3054959
	speed: 0.0277s/iter; left time: 48.0218s
	iters: 500, epoch: 9 | loss: 0.3936409
	speed: 0.0264s/iter; left time: 43.0964s
	iters: 600, epoch: 9 | loss: 0.3488112
	speed: 0.0194s/iter; left time: 29.6820s
	iters: 700, epoch: 9 | loss: 0.3685415
	speed: 0.0195s/iter; left time: 27.9304s
	iters: 800, epoch: 9 | loss: 0.4300971
	speed: 0.0161s/iter; left time: 21.4974s
	iters: 900, epoch: 9 | loss: 0.3637230
	speed: 0.0168s/iter; left time: 20.7709s
	iters: 1000, epoch: 9 | loss: 0.3828993
	speed: 0.0160s/iter; left time: 18.1556s
Epoch: 9 cost time: 22.55731964111328
Epoch: 9, Steps: 1066 | Train Loss: 0.3904215 Vali Loss: 0.6652968 Test Loss: 0.4112696
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.4485097
	speed: 1.5669s/iter; left time: 1515.1566s
	iters: 200, epoch: 10 | loss: 0.3673626
	speed: 0.0191s/iter; left time: 16.5913s
	iters: 300, epoch: 10 | loss: 0.3660711
	speed: 0.0183s/iter; left time: 14.0155s
	iters: 400, epoch: 10 | loss: 0.5230851
	speed: 0.0167s/iter; left time: 11.1058s
	iters: 500, epoch: 10 | loss: 0.3701716
	speed: 0.0176s/iter; left time: 9.9976s
	iters: 600, epoch: 10 | loss: 0.3848145
	speed: 0.0177s/iter; left time: 8.2570s
	iters: 700, epoch: 10 | loss: 0.3906344
	speed: 0.0187s/iter; left time: 6.8774s
	iters: 800, epoch: 10 | loss: 0.3256345
	speed: 0.0176s/iter; left time: 4.6957s
	iters: 900, epoch: 10 | loss: 0.3389741
	speed: 0.0162s/iter; left time: 2.7074s
	iters: 1000, epoch: 10 | loss: 0.4876750
	speed: 0.0167s/iter; left time: 1.1176s
Epoch: 10 cost time: 18.98104166984558
Epoch: 10, Steps: 1066 | Train Loss: 0.3902094 Vali Loss: 0.6654673 Test Loss: 0.4112434
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_336_iMamba_ETTm1_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.4114074409008026, mae:0.41576120257377625

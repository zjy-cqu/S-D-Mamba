Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_192', model='iMamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_192_iMamba_ETTm1_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.5350105
	speed: 0.0277s/iter; left time: 294.0489s
	iters: 200, epoch: 1 | loss: 0.4453884
	speed: 0.0206s/iter; left time: 216.9556s
	iters: 300, epoch: 1 | loss: 0.3880847
	speed: 0.0222s/iter; left time: 230.6801s
	iters: 400, epoch: 1 | loss: 0.4988043
	speed: 0.0241s/iter; left time: 248.3700s
	iters: 500, epoch: 1 | loss: 0.3305933
	speed: 0.0260s/iter; left time: 265.8579s
	iters: 600, epoch: 1 | loss: 0.4997184
	speed: 0.0256s/iter; left time: 258.3430s
	iters: 700, epoch: 1 | loss: 0.5227813
	speed: 0.0251s/iter; left time: 251.7447s
	iters: 800, epoch: 1 | loss: 0.3860718
	speed: 0.0250s/iter; left time: 248.1767s
	iters: 900, epoch: 1 | loss: 0.3586500
	speed: 0.0269s/iter; left time: 264.3073s
	iters: 1000, epoch: 1 | loss: 0.3604566
	speed: 0.0274s/iter; left time: 266.4675s
Epoch: 1 cost time: 27.023826360702515
Epoch: 1, Steps: 1071 | Train Loss: 0.4262653 Vali Loss: 0.5462425 Test Loss: 0.4070444
Validation loss decreased (inf --> 0.546243).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.3926915
	speed: 1.6898s/iter; left time: 16120.6066s
	iters: 200, epoch: 2 | loss: 0.3421334
	speed: 0.0187s/iter; left time: 176.8946s
	iters: 300, epoch: 2 | loss: 0.4068926
	speed: 0.0187s/iter; left time: 174.5661s
	iters: 400, epoch: 2 | loss: 0.3849336
	speed: 0.0198s/iter; left time: 182.8368s
	iters: 500, epoch: 2 | loss: 0.2913043
	speed: 0.0184s/iter; left time: 168.1349s
	iters: 600, epoch: 2 | loss: 0.3648528
	speed: 0.0185s/iter; left time: 166.9821s
	iters: 700, epoch: 2 | loss: 0.3102596
	speed: 0.0183s/iter; left time: 164.0237s
	iters: 800, epoch: 2 | loss: 0.3721454
	speed: 0.0196s/iter; left time: 173.0216s
	iters: 900, epoch: 2 | loss: 0.3583573
	speed: 0.0209s/iter; left time: 182.6051s
	iters: 1000, epoch: 2 | loss: 0.3221190
	speed: 0.0220s/iter; left time: 189.7646s
Epoch: 2 cost time: 21.35506582260132
Epoch: 2, Steps: 1071 | Train Loss: 0.3580253 Vali Loss: 0.5246124 Test Loss: 0.3856519
Validation loss decreased (0.546243 --> 0.524612).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.3191286
	speed: 1.7183s/iter; left time: 14552.6145s
	iters: 200, epoch: 3 | loss: 0.3372433
	speed: 0.0188s/iter; left time: 157.2017s
	iters: 300, epoch: 3 | loss: 0.2911122
	speed: 0.0188s/iter; left time: 155.7104s
	iters: 400, epoch: 3 | loss: 0.3093350
	speed: 0.0195s/iter; left time: 159.3897s
	iters: 500, epoch: 3 | loss: 0.3311240
	speed: 0.0189s/iter; left time: 152.8990s
	iters: 600, epoch: 3 | loss: 0.3061091
	speed: 0.0225s/iter; left time: 179.5199s
	iters: 700, epoch: 3 | loss: 0.3789605
	speed: 0.0204s/iter; left time: 160.8193s
	iters: 800, epoch: 3 | loss: 0.3431093
	speed: 0.0184s/iter; left time: 142.5759s
	iters: 900, epoch: 3 | loss: 0.3090439
	speed: 0.0188s/iter; left time: 144.4754s
	iters: 1000, epoch: 3 | loss: 0.2917435
	speed: 0.0190s/iter; left time: 143.5310s
Epoch: 3 cost time: 20.969993352890015
Epoch: 3, Steps: 1071 | Train Loss: 0.3448520 Vali Loss: 0.5201579 Test Loss: 0.3821754
Validation loss decreased (0.524612 --> 0.520158).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.3423878
	speed: 1.6318s/iter; left time: 12071.7375s
	iters: 200, epoch: 4 | loss: 0.2857735
	speed: 0.0213s/iter; left time: 155.1072s
	iters: 300, epoch: 4 | loss: 0.3233847
	speed: 0.0188s/iter; left time: 135.1363s
	iters: 400, epoch: 4 | loss: 0.3318487
	speed: 0.0267s/iter; left time: 189.4468s
	iters: 500, epoch: 4 | loss: 0.2835477
	speed: 0.0210s/iter; left time: 147.2224s
	iters: 600, epoch: 4 | loss: 0.3795328
	speed: 0.0239s/iter; left time: 164.5935s
	iters: 700, epoch: 4 | loss: 0.3815029
	speed: 0.0287s/iter; left time: 194.8031s
	iters: 800, epoch: 4 | loss: 0.3112900
	speed: 0.0183s/iter; left time: 122.7912s
	iters: 900, epoch: 4 | loss: 0.3205759
	speed: 0.0185s/iter; left time: 122.1516s
	iters: 1000, epoch: 4 | loss: 0.4499482
	speed: 0.0187s/iter; left time: 121.4586s
Epoch: 4 cost time: 23.230223417282104
Epoch: 4, Steps: 1071 | Train Loss: 0.3406223 Vali Loss: 0.5187914 Test Loss: 0.3797414
Validation loss decreased (0.520158 --> 0.518791).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.3097703
	speed: 1.6761s/iter; left time: 10604.5069s
	iters: 200, epoch: 5 | loss: 0.3281008
	speed: 0.0183s/iter; left time: 114.1518s
	iters: 300, epoch: 5 | loss: 0.3837382
	speed: 0.0197s/iter; left time: 120.9448s
	iters: 400, epoch: 5 | loss: 0.2967914
	speed: 0.0242s/iter; left time: 145.8150s
	iters: 500, epoch: 5 | loss: 0.3322305
	speed: 0.0236s/iter; left time: 140.1205s
	iters: 600, epoch: 5 | loss: 0.3332092
	speed: 0.0289s/iter; left time: 168.6473s
	iters: 700, epoch: 5 | loss: 0.3735117
	speed: 0.0187s/iter; left time: 107.0208s
	iters: 800, epoch: 5 | loss: 0.4537436
	speed: 0.0184s/iter; left time: 103.7301s
	iters: 900, epoch: 5 | loss: 0.3002453
	speed: 0.0193s/iter; left time: 106.7407s
	iters: 1000, epoch: 5 | loss: 0.3507029
	speed: 0.0238s/iter; left time: 129.3689s
Epoch: 5 cost time: 23.17198944091797
Epoch: 5, Steps: 1071 | Train Loss: 0.3389164 Vali Loss: 0.5178528 Test Loss: 0.3793199
Validation loss decreased (0.518791 --> 0.517853).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.3607091
	speed: 1.6679s/iter; left time: 8766.6011s
	iters: 200, epoch: 6 | loss: 0.3832047
	speed: 0.0185s/iter; left time: 95.6369s
	iters: 300, epoch: 6 | loss: 0.3342882
	speed: 0.0185s/iter; left time: 93.5206s
	iters: 400, epoch: 6 | loss: 0.3245050
	speed: 0.0188s/iter; left time: 93.0030s
	iters: 500, epoch: 6 | loss: 0.3441744
	speed: 0.0188s/iter; left time: 91.1424s
	iters: 600, epoch: 6 | loss: 0.3270434
	speed: 0.0185s/iter; left time: 88.1972s
	iters: 700, epoch: 6 | loss: 0.3272573
	speed: 0.0220s/iter; left time: 102.3490s
	iters: 800, epoch: 6 | loss: 0.3646498
	speed: 0.0190s/iter; left time: 86.6323s
	iters: 900, epoch: 6 | loss: 0.3320389
	speed: 0.0185s/iter; left time: 82.2251s
	iters: 1000, epoch: 6 | loss: 0.3497967
	speed: 0.0185s/iter; left time: 80.7926s
Epoch: 6 cost time: 20.56571316719055
Epoch: 6, Steps: 1071 | Train Loss: 0.3380234 Vali Loss: 0.5176900 Test Loss: 0.3787052
Validation loss decreased (0.517853 --> 0.517690).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.3763733
	speed: 1.5970s/iter; left time: 6683.4081s
	iters: 200, epoch: 7 | loss: 0.3083531
	speed: 0.0208s/iter; left time: 84.9025s
	iters: 300, epoch: 7 | loss: 0.3709066
	speed: 0.0227s/iter; left time: 90.5245s
	iters: 400, epoch: 7 | loss: 0.3755287
	speed: 0.0213s/iter; left time: 82.5621s
	iters: 500, epoch: 7 | loss: 0.2736946
	speed: 0.0255s/iter; left time: 96.4540s
	iters: 600, epoch: 7 | loss: 0.2984645
	speed: 0.0184s/iter; left time: 67.8880s
	iters: 700, epoch: 7 | loss: 0.3199595
	speed: 0.0183s/iter; left time: 65.5918s
	iters: 800, epoch: 7 | loss: 0.3363422
	speed: 0.0184s/iter; left time: 64.1165s
	iters: 900, epoch: 7 | loss: 0.3638963
	speed: 0.0185s/iter; left time: 62.5103s
	iters: 1000, epoch: 7 | loss: 0.3515375
	speed: 0.0249s/iter; left time: 81.7418s
Epoch: 7 cost time: 22.59414005279541
Epoch: 7, Steps: 1071 | Train Loss: 0.3375461 Vali Loss: 0.5173163 Test Loss: 0.3787445
Validation loss decreased (0.517690 --> 0.517316).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.3908834
	speed: 1.6955s/iter; left time: 5279.8520s
	iters: 200, epoch: 8 | loss: 0.3891315
	speed: 0.0202s/iter; left time: 60.7388s
	iters: 300, epoch: 8 | loss: 0.3929201
	speed: 0.0192s/iter; left time: 55.9196s
	iters: 400, epoch: 8 | loss: 0.4321600
	speed: 0.0193s/iter; left time: 54.4204s
	iters: 500, epoch: 8 | loss: 0.2928951
	speed: 0.0186s/iter; left time: 50.4507s
	iters: 600, epoch: 8 | loss: 0.3338711
	speed: 0.0187s/iter; left time: 48.8519s
	iters: 700, epoch: 8 | loss: 0.3183995
	speed: 0.0185s/iter; left time: 46.6080s
	iters: 800, epoch: 8 | loss: 0.3177318
	speed: 0.0184s/iter; left time: 44.4674s
	iters: 900, epoch: 8 | loss: 0.4239064
	speed: 0.0185s/iter; left time: 42.7893s
	iters: 1000, epoch: 8 | loss: 0.2776392
	speed: 0.0185s/iter; left time: 40.9359s
Epoch: 8 cost time: 20.591481685638428
Epoch: 8, Steps: 1071 | Train Loss: 0.3373870 Vali Loss: 0.5172925 Test Loss: 0.3786807
Validation loss decreased (0.517316 --> 0.517292).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.2959624
	speed: 1.5696s/iter; left time: 3206.6943s
	iters: 200, epoch: 9 | loss: 0.3785077
	speed: 0.0198s/iter; left time: 38.4891s
	iters: 300, epoch: 9 | loss: 0.3222951
	speed: 0.0210s/iter; left time: 38.6135s
	iters: 400, epoch: 9 | loss: 0.3135797
	speed: 0.0192s/iter; left time: 33.4853s
	iters: 500, epoch: 9 | loss: 0.2936685
	speed: 0.0193s/iter; left time: 31.6402s
	iters: 600, epoch: 9 | loss: 0.3573336
	speed: 0.0194s/iter; left time: 29.9854s
	iters: 700, epoch: 9 | loss: 0.2739724
	speed: 0.0188s/iter; left time: 27.0646s
	iters: 800, epoch: 9 | loss: 0.2766025
	speed: 0.0195s/iter; left time: 26.1332s
	iters: 900, epoch: 9 | loss: 0.3552366
	speed: 0.0189s/iter; left time: 23.4548s
	iters: 1000, epoch: 9 | loss: 0.3744777
	speed: 0.0183s/iter; left time: 20.9701s
Epoch: 9 cost time: 20.823717832565308
Epoch: 9, Steps: 1071 | Train Loss: 0.3373454 Vali Loss: 0.5172877 Test Loss: 0.3786462
Validation loss decreased (0.517292 --> 0.517288).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.3111143
	speed: 1.5842s/iter; left time: 1539.8337s
	iters: 200, epoch: 10 | loss: 0.3310284
	speed: 0.0189s/iter; left time: 16.4545s
	iters: 300, epoch: 10 | loss: 0.3908598
	speed: 0.0209s/iter; left time: 16.1683s
	iters: 400, epoch: 10 | loss: 0.3134030
	speed: 0.0184s/iter; left time: 12.3579s
	iters: 500, epoch: 10 | loss: 0.3486750
	speed: 0.0186s/iter; left time: 10.6169s
	iters: 600, epoch: 10 | loss: 0.2940686
	speed: 0.0194s/iter; left time: 9.1333s
	iters: 700, epoch: 10 | loss: 0.2745888
	speed: 0.0163s/iter; left time: 6.0800s
	iters: 800, epoch: 10 | loss: 0.3319004
	speed: 0.0200s/iter; left time: 5.4319s
	iters: 900, epoch: 10 | loss: 0.3090371
	speed: 0.0195s/iter; left time: 3.3596s
	iters: 1000, epoch: 10 | loss: 0.3070310
	speed: 0.0184s/iter; left time: 1.3283s
Epoch: 10 cost time: 20.575302362442017
Epoch: 10, Steps: 1071 | Train Loss: 0.3371998 Vali Loss: 0.5172735 Test Loss: 0.3786349
Validation loss decreased (0.517288 --> 0.517274).  Saving model ...
Updating learning rate to 9.765625e-08
>>>>>>>testing : ETTm1_96_192_iMamba_ETTm1_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 1, 192, 7) (11329, 1, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.378635436296463, mae:0.3941796123981476

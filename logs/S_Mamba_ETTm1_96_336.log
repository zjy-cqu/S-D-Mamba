Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_336', model='S_Mamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_336_S_Mamba_ETTm1_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5616987
	speed: 0.0300s/iter; left time: 317.0669s
	iters: 200, epoch: 1 | loss: 0.4437250
	speed: 0.0225s/iter; left time: 234.9026s
	iters: 300, epoch: 1 | loss: 0.4132427
	speed: 0.0240s/iter; left time: 248.5810s
	iters: 400, epoch: 1 | loss: 0.5679676
	speed: 0.0246s/iter; left time: 252.5600s
	iters: 500, epoch: 1 | loss: 0.5285152
	speed: 0.0230s/iter; left time: 233.9435s
	iters: 600, epoch: 1 | loss: 0.4344604
	speed: 0.0248s/iter; left time: 249.6474s
	iters: 700, epoch: 1 | loss: 0.3960238
	speed: 0.0241s/iter; left time: 240.1101s
	iters: 800, epoch: 1 | loss: 0.4216562
	speed: 0.0282s/iter; left time: 277.9765s
	iters: 900, epoch: 1 | loss: 0.3856496
	speed: 0.0232s/iter; left time: 226.3165s
	iters: 1000, epoch: 1 | loss: 0.3565867
	speed: 0.0192s/iter; left time: 185.0239s
Epoch: 1 cost time: 25.629255056381226
Epoch: 1, Steps: 1066 | Train Loss: 0.4576749 Vali Loss: 0.6828743 Test Loss: 0.4293988
Validation loss decreased (inf --> 0.682874).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.3789670
	speed: 0.5466s/iter; left time: 5189.7382s
	iters: 200, epoch: 2 | loss: 0.3277779
	speed: 0.0216s/iter; left time: 202.4929s
	iters: 300, epoch: 2 | loss: 0.3558661
	speed: 0.0182s/iter; left time: 169.5154s
	iters: 400, epoch: 2 | loss: 0.3611757
	speed: 0.0193s/iter; left time: 177.3852s
	iters: 500, epoch: 2 | loss: 0.3902948
	speed: 0.0196s/iter; left time: 177.8285s
	iters: 600, epoch: 2 | loss: 0.4533589
	speed: 0.0196s/iter; left time: 176.3366s
	iters: 700, epoch: 2 | loss: 0.3916804
	speed: 0.0196s/iter; left time: 174.1931s
	iters: 800, epoch: 2 | loss: 0.3980534
	speed: 0.0193s/iter; left time: 169.6642s
	iters: 900, epoch: 2 | loss: 0.4033816
	speed: 0.0195s/iter; left time: 169.1685s
	iters: 1000, epoch: 2 | loss: 0.3680114
	speed: 0.0184s/iter; left time: 158.2201s
Epoch: 2 cost time: 20.967673301696777
Epoch: 2, Steps: 1066 | Train Loss: 0.3975410 Vali Loss: 0.6652114 Test Loss: 0.4132455
Validation loss decreased (0.682874 --> 0.665211).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.3842529
	speed: 0.5819s/iter; left time: 4904.4310s
	iters: 200, epoch: 3 | loss: 0.3270220
	speed: 0.0238s/iter; left time: 197.9511s
	iters: 300, epoch: 3 | loss: 0.3592609
	speed: 0.0227s/iter; left time: 187.0702s
	iters: 400, epoch: 3 | loss: 0.3255325
	speed: 0.0257s/iter; left time: 209.0099s
	iters: 500, epoch: 3 | loss: 0.3258733
	speed: 0.0270s/iter; left time: 217.0152s
	iters: 600, epoch: 3 | loss: 0.4081052
	speed: 0.0260s/iter; left time: 205.9848s
	iters: 700, epoch: 3 | loss: 0.3449678
	speed: 0.0286s/iter; left time: 224.2391s
	iters: 800, epoch: 3 | loss: 0.4435981
	speed: 0.0272s/iter; left time: 210.2522s
	iters: 900, epoch: 3 | loss: 0.4321451
	speed: 0.0276s/iter; left time: 210.8644s
	iters: 1000, epoch: 3 | loss: 0.3923050
	speed: 0.0292s/iter; left time: 219.8286s
Epoch: 3 cost time: 28.197673559188843
Epoch: 3, Steps: 1066 | Train Loss: 0.3855239 Vali Loss: 0.6596126 Test Loss: 0.4109651
Validation loss decreased (0.665211 --> 0.659613).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.4093568
	speed: 0.5538s/iter; left time: 4077.4338s
	iters: 200, epoch: 4 | loss: 0.2799841
	speed: 0.0186s/iter; left time: 134.9404s
	iters: 300, epoch: 4 | loss: 0.3208866
	speed: 0.0184s/iter; left time: 131.5569s
	iters: 400, epoch: 4 | loss: 0.3784298
	speed: 0.0192s/iter; left time: 135.3743s
	iters: 500, epoch: 4 | loss: 0.3653818
	speed: 0.0224s/iter; left time: 155.6739s
	iters: 600, epoch: 4 | loss: 0.4675019
	speed: 0.0237s/iter; left time: 162.4989s
	iters: 700, epoch: 4 | loss: 0.4552542
	speed: 0.0235s/iter; left time: 158.8082s
	iters: 800, epoch: 4 | loss: 0.4002412
	speed: 0.0208s/iter; left time: 138.5011s
	iters: 900, epoch: 4 | loss: 0.3607882
	speed: 0.0213s/iter; left time: 139.8220s
	iters: 1000, epoch: 4 | loss: 0.4194849
	speed: 0.0199s/iter; left time: 128.6224s
Epoch: 4 cost time: 22.203786611557007
Epoch: 4, Steps: 1066 | Train Loss: 0.3814432 Vali Loss: 0.6582671 Test Loss: 0.4098015
Validation loss decreased (0.659613 --> 0.658267).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.3816682
	speed: 0.5697s/iter; left time: 3587.1975s
	iters: 200, epoch: 5 | loss: 0.3803820
	speed: 0.0263s/iter; left time: 162.8073s
	iters: 300, epoch: 5 | loss: 0.3580961
	speed: 0.0257s/iter; left time: 156.7550s
	iters: 400, epoch: 5 | loss: 0.3475187
	speed: 0.0247s/iter; left time: 147.8505s
	iters: 500, epoch: 5 | loss: 0.3761709
	speed: 0.0245s/iter; left time: 144.2553s
	iters: 600, epoch: 5 | loss: 0.4790448
	speed: 0.0215s/iter; left time: 124.6731s
	iters: 700, epoch: 5 | loss: 0.3897013
	speed: 0.0239s/iter; left time: 136.1711s
	iters: 800, epoch: 5 | loss: 0.3428375
	speed: 0.0230s/iter; left time: 128.5780s
	iters: 900, epoch: 5 | loss: 0.4015444
	speed: 0.0253s/iter; left time: 138.8648s
	iters: 1000, epoch: 5 | loss: 0.3908030
	speed: 0.0251s/iter; left time: 135.3723s
Epoch: 5 cost time: 26.34370470046997
Epoch: 5, Steps: 1066 | Train Loss: 0.3797575 Vali Loss: 0.6577774 Test Loss: 0.4096589
Validation loss decreased (0.658267 --> 0.657777).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.4642324
	speed: 0.5631s/iter; left time: 2945.6536s
	iters: 200, epoch: 6 | loss: 0.3872020
	speed: 0.0237s/iter; left time: 121.8484s
	iters: 300, epoch: 6 | loss: 0.3322555
	speed: 0.0221s/iter; left time: 111.1262s
	iters: 400, epoch: 6 | loss: 0.3588942
	speed: 0.0232s/iter; left time: 114.5323s
	iters: 500, epoch: 6 | loss: 0.3666793
	speed: 0.0254s/iter; left time: 122.7251s
	iters: 600, epoch: 6 | loss: 0.4335837
	speed: 0.0241s/iter; left time: 114.2025s
	iters: 700, epoch: 6 | loss: 0.3303087
	speed: 0.0244s/iter; left time: 112.8954s
	iters: 800, epoch: 6 | loss: 0.3084382
	speed: 0.0265s/iter; left time: 120.2540s
	iters: 900, epoch: 6 | loss: 0.3370700
	speed: 0.0253s/iter; left time: 112.1206s
	iters: 1000, epoch: 6 | loss: 0.3043762
	speed: 0.0249s/iter; left time: 107.6703s
Epoch: 6 cost time: 26.536765813827515
Epoch: 6, Steps: 1066 | Train Loss: 0.3787229 Vali Loss: 0.6571305 Test Loss: 0.4095019
Validation loss decreased (0.657777 --> 0.657130).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.3510231
	speed: 0.5879s/iter; left time: 2448.4361s
	iters: 200, epoch: 7 | loss: 0.5247300
	speed: 0.0271s/iter; left time: 110.0719s
	iters: 300, epoch: 7 | loss: 0.4325970
	speed: 0.0287s/iter; left time: 113.6070s
	iters: 400, epoch: 7 | loss: 0.3546912
	speed: 0.0254s/iter; left time: 98.2142s
	iters: 500, epoch: 7 | loss: 0.3007734
	speed: 0.0280s/iter; left time: 105.3759s
	iters: 600, epoch: 7 | loss: 0.3128673
	speed: 0.0247s/iter; left time: 90.4534s
	iters: 700, epoch: 7 | loss: 0.4190243
	speed: 0.0274s/iter; left time: 97.8462s
	iters: 800, epoch: 7 | loss: 0.4624969
	speed: 0.0266s/iter; left time: 92.2344s
	iters: 900, epoch: 7 | loss: 0.4923680
	speed: 0.0266s/iter; left time: 89.6206s
	iters: 1000, epoch: 7 | loss: 0.3076483
	speed: 0.0275s/iter; left time: 89.6243s
Epoch: 7 cost time: 28.60472345352173
Epoch: 7, Steps: 1066 | Train Loss: 0.3784770 Vali Loss: 0.6570714 Test Loss: 0.4096726
Validation loss decreased (0.657130 --> 0.657071).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.4181086
	speed: 0.6000s/iter; left time: 1859.5198s
	iters: 200, epoch: 8 | loss: 0.3540955
	speed: 0.0254s/iter; left time: 76.2283s
	iters: 300, epoch: 8 | loss: 0.4800467
	speed: 0.0231s/iter; left time: 67.0161s
	iters: 400, epoch: 8 | loss: 0.4022346
	speed: 0.0181s/iter; left time: 50.6464s
	iters: 500, epoch: 8 | loss: 0.3523425
	speed: 0.0192s/iter; left time: 51.7058s
	iters: 600, epoch: 8 | loss: 0.3740886
	speed: 0.0216s/iter; left time: 56.0743s
	iters: 700, epoch: 8 | loss: 0.2903223
	speed: 0.0237s/iter; left time: 59.2603s
	iters: 800, epoch: 8 | loss: 0.3404194
	speed: 0.0254s/iter; left time: 60.8186s
	iters: 900, epoch: 8 | loss: 0.3267942
	speed: 0.0257s/iter; left time: 59.1433s
	iters: 1000, epoch: 8 | loss: 0.3568466
	speed: 0.0249s/iter; left time: 54.7951s
Epoch: 8 cost time: 24.964470148086548
Epoch: 8, Steps: 1066 | Train Loss: 0.3782188 Vali Loss: 0.6569197 Test Loss: 0.4096109
Validation loss decreased (0.657071 --> 0.656920).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.3661443
	speed: 0.6155s/iter; left time: 1251.2696s
	iters: 200, epoch: 9 | loss: 0.3623977
	speed: 0.0270s/iter; left time: 52.2247s
	iters: 300, epoch: 9 | loss: 0.4025792
	speed: 0.0273s/iter; left time: 50.0080s
	iters: 400, epoch: 9 | loss: 0.4039835
	speed: 0.0200s/iter; left time: 34.7445s
	iters: 500, epoch: 9 | loss: 0.3217786
	speed: 0.0214s/iter; left time: 34.9894s
	iters: 600, epoch: 9 | loss: 0.4313663
	speed: 0.0198s/iter; left time: 30.3876s
	iters: 700, epoch: 9 | loss: 0.4343362
	speed: 0.0221s/iter; left time: 31.6533s
	iters: 800, epoch: 9 | loss: 0.3274211
	speed: 0.0226s/iter; left time: 30.1352s
	iters: 900, epoch: 9 | loss: 0.3628845
	speed: 0.0222s/iter; left time: 27.3306s
	iters: 1000, epoch: 9 | loss: 0.3386144
	speed: 0.0200s/iter; left time: 22.6698s
Epoch: 9 cost time: 24.534143209457397
Epoch: 9, Steps: 1066 | Train Loss: 0.3780935 Vali Loss: 0.6569439 Test Loss: 0.4095705
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.3297969
	speed: 0.6552s/iter; left time: 633.5712s
	iters: 200, epoch: 10 | loss: 0.4655701
	speed: 0.0257s/iter; left time: 22.2789s
	iters: 300, epoch: 10 | loss: 0.4013163
	speed: 0.0257s/iter; left time: 19.7034s
	iters: 400, epoch: 10 | loss: 0.4141849
	speed: 0.0249s/iter; left time: 16.5917s
	iters: 500, epoch: 10 | loss: 0.3597983
	speed: 0.0251s/iter; left time: 14.2465s
	iters: 600, epoch: 10 | loss: 0.3276424
	speed: 0.0248s/iter; left time: 11.5737s
	iters: 700, epoch: 10 | loss: 0.3887101
	speed: 0.0248s/iter; left time: 9.1000s
	iters: 800, epoch: 10 | loss: 0.3763050
	speed: 0.0231s/iter; left time: 6.1746s
	iters: 900, epoch: 10 | loss: 0.2819323
	speed: 0.0234s/iter; left time: 3.9087s
	iters: 1000, epoch: 10 | loss: 0.3552777
	speed: 0.0241s/iter; left time: 1.6136s
Epoch: 10 cost time: 26.085732460021973
Epoch: 10, Steps: 1066 | Train Loss: 0.3781215 Vali Loss: 0.6569922 Test Loss: 0.4095592
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
>>>>>>>testing : ETTm1_96_336_S_Mamba_ETTm1_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.4096105098724365, mae:0.41439104080200195

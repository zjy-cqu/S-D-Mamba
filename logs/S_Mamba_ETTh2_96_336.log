Args in experiment:
Namespace(is_training=1, model_id='ETTh2_96_336', model='S_Mamba', data='ETTh2', root_path='./dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=3e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_96_336_S_Mamba_ETTh2_M_ft96_sl48_ll336_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.8863413
	speed: 0.0237s/iter; left time: 58.4044s
	iters: 200, epoch: 1 | loss: 0.8168922
	speed: 0.0175s/iter; left time: 41.3389s
Epoch: 1 cost time: 5.289591073989868
Epoch: 1, Steps: 256 | Train Loss: 0.7300266 Vali Loss: 0.3937818 Test Loss: 0.4503306
Validation loss decreased (inf --> 0.393782).  Saving model ...
Updating learning rate to 3e-05
	iters: 100, epoch: 2 | loss: 0.4320742
	speed: 0.1512s/iter; left time: 333.3673s
	iters: 200, epoch: 2 | loss: 0.8627939
	speed: 0.0230s/iter; left time: 48.4914s
Epoch: 2 cost time: 6.055943489074707
Epoch: 2, Steps: 256 | Train Loss: 0.6769372 Vali Loss: 0.3735338 Test Loss: 0.4316444
Validation loss decreased (0.393782 --> 0.373534).  Saving model ...
Updating learning rate to 1.5e-05
	iters: 100, epoch: 3 | loss: 1.1821181
	speed: 0.1663s/iter; left time: 324.0584s
	iters: 200, epoch: 3 | loss: 0.5665915
	speed: 0.0258s/iter; left time: 47.6715s
Epoch: 3 cost time: 6.561468601226807
Epoch: 3, Steps: 256 | Train Loss: 0.6551479 Vali Loss: 0.3698676 Test Loss: 0.4270597
Validation loss decreased (0.373534 --> 0.369868).  Saving model ...
Updating learning rate to 7.5e-06
	iters: 100, epoch: 4 | loss: 0.4333843
	speed: 0.1563s/iter; left time: 264.5673s
	iters: 200, epoch: 4 | loss: 0.9662300
	speed: 0.0205s/iter; left time: 32.6221s
Epoch: 4 cost time: 5.538586616516113
Epoch: 4, Steps: 256 | Train Loss: 0.6465525 Vali Loss: 0.3685311 Test Loss: 0.4258333
Validation loss decreased (0.369868 --> 0.368531).  Saving model ...
Updating learning rate to 3.75e-06
	iters: 100, epoch: 5 | loss: 0.5354162
	speed: 0.1562s/iter; left time: 224.5303s
	iters: 200, epoch: 5 | loss: 0.9382134
	speed: 0.0205s/iter; left time: 27.3832s
Epoch: 5 cost time: 5.596962928771973
Epoch: 5, Steps: 256 | Train Loss: 0.6439305 Vali Loss: 0.3683302 Test Loss: 0.4255589
Validation loss decreased (0.368531 --> 0.368330).  Saving model ...
Updating learning rate to 1.875e-06
	iters: 100, epoch: 6 | loss: 0.6698890
	speed: 0.1518s/iter; left time: 179.2479s
	iters: 200, epoch: 6 | loss: 0.5159145
	speed: 0.0176s/iter; left time: 19.0391s
Epoch: 6 cost time: 5.2288172245025635
Epoch: 6, Steps: 256 | Train Loss: 0.6428853 Vali Loss: 0.3667350 Test Loss: 0.4254206
Validation loss decreased (0.368330 --> 0.366735).  Saving model ...
Updating learning rate to 9.375e-07
	iters: 100, epoch: 7 | loss: 1.1838695
	speed: 0.1603s/iter; left time: 148.2729s
	iters: 200, epoch: 7 | loss: 1.0595530
	speed: 0.0223s/iter; left time: 18.4307s
Epoch: 7 cost time: 5.729970216751099
Epoch: 7, Steps: 256 | Train Loss: 0.6416774 Vali Loss: 0.3669719 Test Loss: 0.4253105
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.6875e-07
	iters: 100, epoch: 8 | loss: 0.3733063
	speed: 0.1521s/iter; left time: 101.7483s
	iters: 200, epoch: 8 | loss: 0.6581771
	speed: 0.0174s/iter; left time: 9.8736s
Epoch: 8 cost time: 4.7114105224609375
Epoch: 8, Steps: 256 | Train Loss: 0.6412778 Vali Loss: 0.3670816 Test Loss: 0.4252835
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.34375e-07
	iters: 100, epoch: 9 | loss: 0.6203647
	speed: 0.1604s/iter; left time: 66.2305s
	iters: 200, epoch: 9 | loss: 0.6555176
	speed: 0.0211s/iter; left time: 6.6026s
Epoch: 9 cost time: 5.617222547531128
Epoch: 9, Steps: 256 | Train Loss: 0.6406242 Vali Loss: 0.3682772 Test Loss: 0.4252669
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh2_96_336_S_Mamba_ETTh2_M_ft96_sl48_ll336_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4254203140735626, mae:0.4351102411746979

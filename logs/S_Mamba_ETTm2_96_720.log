Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_720', model='S_Mamba', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_720_S_Mamba_ETTm2_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4775229
	speed: 0.0293s/iter; left time: 305.6348s
	iters: 200, epoch: 1 | loss: 0.6031642
	speed: 0.0225s/iter; left time: 232.2341s
	iters: 300, epoch: 1 | loss: 0.6876251
	speed: 0.0226s/iter; left time: 231.2856s
	iters: 400, epoch: 1 | loss: 0.6201802
	speed: 0.0210s/iter; left time: 213.4348s
	iters: 500, epoch: 1 | loss: 0.3746108
	speed: 0.0215s/iter; left time: 215.7615s
	iters: 600, epoch: 1 | loss: 0.4976020
	speed: 0.0234s/iter; left time: 232.8652s
	iters: 700, epoch: 1 | loss: 0.4410350
	speed: 0.0235s/iter; left time: 231.4410s
	iters: 800, epoch: 1 | loss: 0.4878840
	speed: 0.0236s/iter; left time: 229.8707s
	iters: 900, epoch: 1 | loss: 0.6817338
	speed: 0.0305s/iter; left time: 293.6970s
	iters: 1000, epoch: 1 | loss: 0.7965199
	speed: 0.0305s/iter; left time: 291.0925s
Epoch: 1 cost time: 26.52792453765869
Epoch: 1, Steps: 1054 | Train Loss: 0.6065438 Vali Loss: 0.2960673 Test Loss: 0.4133775
Validation loss decreased (inf --> 0.296067).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.7421797
	speed: 0.5198s/iter; left time: 4879.0907s
	iters: 200, epoch: 2 | loss: 0.4590026
	speed: 0.0304s/iter; left time: 282.1993s
	iters: 300, epoch: 2 | loss: 0.5418105
	speed: 0.0234s/iter; left time: 214.5645s
	iters: 400, epoch: 2 | loss: 0.9159736
	speed: 0.0220s/iter; left time: 199.6536s
	iters: 500, epoch: 2 | loss: 0.8952517
	speed: 0.0260s/iter; left time: 233.5873s
	iters: 600, epoch: 2 | loss: 0.9543226
	speed: 0.0295s/iter; left time: 261.9032s
	iters: 700, epoch: 2 | loss: 0.2858120
	speed: 0.0297s/iter; left time: 260.6674s
	iters: 800, epoch: 2 | loss: 0.3931783
	speed: 0.0217s/iter; left time: 188.1318s
	iters: 900, epoch: 2 | loss: 0.2935326
	speed: 0.0184s/iter; left time: 157.8939s
	iters: 1000, epoch: 2 | loss: 0.6313990
	speed: 0.0185s/iter; left time: 156.9345s
Epoch: 2 cost time: 26.146336555480957
Epoch: 2, Steps: 1054 | Train Loss: 0.5763461 Vali Loss: 0.2984693 Test Loss: 0.4122503
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.3060118
	speed: 0.5036s/iter; left time: 4196.7449s
	iters: 200, epoch: 3 | loss: 0.5976397
	speed: 0.0235s/iter; left time: 193.6309s
	iters: 300, epoch: 3 | loss: 0.5661579
	speed: 0.0240s/iter; left time: 195.2716s
	iters: 400, epoch: 3 | loss: 1.5274252
	speed: 0.0261s/iter; left time: 209.4686s
	iters: 500, epoch: 3 | loss: 0.4096928
	speed: 0.0282s/iter; left time: 223.6849s
	iters: 600, epoch: 3 | loss: 0.7401208
	speed: 0.0281s/iter; left time: 219.9258s
	iters: 700, epoch: 3 | loss: 0.4160431
	speed: 0.0281s/iter; left time: 217.0964s
	iters: 800, epoch: 3 | loss: 0.6553313
	speed: 0.0290s/iter; left time: 221.2334s
	iters: 900, epoch: 3 | loss: 0.4034153
	speed: 0.0290s/iter; left time: 218.7946s
	iters: 1000, epoch: 3 | loss: 0.5343288
	speed: 0.0285s/iter; left time: 211.8568s
Epoch: 3 cost time: 28.553528547286987
Epoch: 3, Steps: 1054 | Train Loss: 0.5587765 Vali Loss: 0.3030000 Test Loss: 0.4136611
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.2995608
	speed: 0.5350s/iter; left time: 3893.9460s
	iters: 200, epoch: 4 | loss: 0.3666171
	speed: 0.0313s/iter; left time: 224.9445s
	iters: 300, epoch: 4 | loss: 0.7663614
	speed: 0.0304s/iter; left time: 214.8487s
	iters: 400, epoch: 4 | loss: 0.5286186
	speed: 0.0312s/iter; left time: 217.9820s
	iters: 500, epoch: 4 | loss: 0.4979636
	speed: 0.0308s/iter; left time: 211.6089s
	iters: 600, epoch: 4 | loss: 0.4948314
	speed: 0.0300s/iter; left time: 203.6006s
	iters: 700, epoch: 4 | loss: 0.6428237
	speed: 0.0304s/iter; left time: 202.8249s
	iters: 800, epoch: 4 | loss: 0.7035129
	speed: 0.0297s/iter; left time: 195.2956s
	iters: 900, epoch: 4 | loss: 0.3251114
	speed: 0.0302s/iter; left time: 195.7218s
	iters: 1000, epoch: 4 | loss: 0.6809192
	speed: 0.0299s/iter; left time: 191.0136s
Epoch: 4 cost time: 32.171576738357544
Epoch: 4, Steps: 1054 | Train Loss: 0.5502763 Vali Loss: 0.3029008 Test Loss: 0.4137928
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_720_S_Mamba_ETTm2_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.41337791085243225, mae:0.40499675273895264

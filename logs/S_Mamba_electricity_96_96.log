Args in experiment:
Namespace(is_training=1, model_id='ECL_96_96', model='S_Mamba', data='custom', root_path='./dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=5, batch_size=16, patience=3, learning_rate=0.001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=16)
Use GPU: cuda:0
>>>>>>>start training : ECL_96_96_S_Mamba_custom_M_ft96_sl48_ll96_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2058477
	speed: 4.2806s/iter; left time: 23932.6582s
	iters: 200, epoch: 1 | loss: 0.1974567
	speed: 4.3170s/iter; left time: 23704.9182s
	iters: 300, epoch: 1 | loss: 0.1518377
	speed: 4.3257s/iter; left time: 23319.7831s
	iters: 400, epoch: 1 | loss: 0.1962351
	speed: 4.3252s/iter; left time: 22884.6561s
	iters: 500, epoch: 1 | loss: 0.1595802
	speed: 4.3232s/iter; left time: 22441.8160s
	iters: 600, epoch: 1 | loss: 0.2307296
	speed: 4.3016s/iter; left time: 21899.3360s
	iters: 700, epoch: 1 | loss: 0.1465541
	speed: 4.2903s/iter; left time: 21413.1364s
	iters: 800, epoch: 1 | loss: 0.1683567
	speed: 4.3040s/iter; left time: 21050.6354s
	iters: 900, epoch: 1 | loss: 0.1448420
	speed: 4.2967s/iter; left time: 20585.3498s
	iters: 1000, epoch: 1 | loss: 0.1395722
	speed: 4.3278s/iter; left time: 20301.6107s
	iters: 1100, epoch: 1 | loss: 0.1477184
	speed: 4.3231s/iter; left time: 19847.4728s
Epoch: 1 cost time: 4910.2055542469025
Epoch: 1, Steps: 1138 | Train Loss: 0.1758882 Vali Loss: 0.1316660 Test Loss: 0.1526958
Validation loss decreased (inf --> 0.131666).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1227669
	speed: 10.9703s/iter; left time: 48850.9593s
	iters: 200, epoch: 2 | loss: 0.1258232
	speed: 4.4375s/iter; left time: 19316.4890s
	iters: 300, epoch: 2 | loss: 0.1325163
	speed: 4.5019s/iter; left time: 19146.7101s
	iters: 400, epoch: 2 | loss: 0.1768523
	speed: 4.4647s/iter; left time: 18541.9096s
	iters: 500, epoch: 2 | loss: 0.1393711
	speed: 4.4344s/iter; left time: 17972.5169s
	iters: 600, epoch: 2 | loss: 0.1307665
	speed: 4.4637s/iter; left time: 17644.8642s
	iters: 700, epoch: 2 | loss: 0.1456589
	speed: 4.4406s/iter; left time: 17109.8010s
	iters: 800, epoch: 2 | loss: 0.1688831
	speed: 4.4438s/iter; left time: 16677.6966s
	iters: 900, epoch: 2 | loss: 0.1246310
	speed: 4.4290s/iter; left time: 16179.0619s
	iters: 1000, epoch: 2 | loss: 0.1562816
	speed: 4.4383s/iter; left time: 15769.1716s
	iters: 1100, epoch: 2 | loss: 0.1271154
	speed: 4.4432s/iter; left time: 15342.5118s
Epoch: 2 cost time: 5051.5805649757385
Epoch: 2, Steps: 1138 | Train Loss: 0.1445953 Vali Loss: 0.1244260 Test Loss: 0.1444805
Validation loss decreased (0.131666 --> 0.124426).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1246815
	speed: 15.1015s/iter; left time: 50061.3318s
	iters: 200, epoch: 3 | loss: 0.1520282
	speed: 4.4440s/iter; left time: 14287.5008s
	iters: 300, epoch: 3 | loss: 0.1162074
	speed: 4.4315s/iter; left time: 13804.0415s
	iters: 400, epoch: 3 | loss: 0.1130470
	speed: 4.4240s/iter; left time: 13338.4178s
	iters: 500, epoch: 3 | loss: 0.1263768
	speed: 4.4393s/iter; left time: 12940.5672s
	iters: 600, epoch: 3 | loss: 0.1319064
	speed: 4.4280s/iter; left time: 12464.7559s
	iters: 700, epoch: 3 | loss: 0.1219728
	speed: 4.4257s/iter; left time: 12015.7331s
	iters: 800, epoch: 3 | loss: 0.1448277
	speed: 4.4210s/iter; left time: 11560.8154s
	iters: 900, epoch: 3 | loss: 0.1301938
	speed: 4.4255s/iter; left time: 11130.1221s
	iters: 1000, epoch: 3 | loss: 0.1172544
	speed: 4.4250s/iter; left time: 10686.4814s
	iters: 1100, epoch: 3 | loss: 0.1459977
	speed: 4.4258s/iter; left time: 10245.7590s
Epoch: 3 cost time: 5041.488445997238
Epoch: 3, Steps: 1138 | Train Loss: 0.1297177 Vali Loss: 0.1218746 Test Loss: 0.1400452
Validation loss decreased (0.124426 --> 0.121875).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1349252
	speed: 15.0623s/iter; left time: 32790.5581s
	iters: 200, epoch: 4 | loss: 0.1070349
	speed: 4.4228s/iter; left time: 9186.2318s
	iters: 300, epoch: 4 | loss: 0.1106048
	speed: 4.4321s/iter; left time: 8762.2863s
	iters: 400, epoch: 4 | loss: 0.1215406
	speed: 4.4182s/iter; left time: 8292.9805s
	iters: 500, epoch: 4 | loss: 0.1128259
	speed: 4.4172s/iter; left time: 7849.4457s
	iters: 600, epoch: 4 | loss: 0.1257275
	speed: 4.4233s/iter; left time: 7417.8373s
	iters: 700, epoch: 4 | loss: 0.1298719
	speed: 4.4195s/iter; left time: 6969.5451s
	iters: 800, epoch: 4 | loss: 0.1067736
	speed: 4.4329s/iter; left time: 6547.3833s
	iters: 900, epoch: 4 | loss: 0.1049546
	speed: 4.4239s/iter; left time: 6091.7440s
	iters: 1000, epoch: 4 | loss: 0.1116647
	speed: 4.4387s/iter; left time: 5668.1949s
	iters: 1100, epoch: 4 | loss: 0.1194069
	speed: 4.4782s/iter; left time: 5270.8057s
Epoch: 4 cost time: 5042.513326883316
Epoch: 4, Steps: 1138 | Train Loss: 0.1164587 Vali Loss: 0.1193100 Test Loss: 0.1412341
Validation loss decreased (0.121875 --> 0.119310).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1204803
	speed: 15.0105s/iter; left time: 15595.8815s
	iters: 200, epoch: 5 | loss: 0.0973563
	speed: 4.4501s/iter; left time: 4178.6744s
	iters: 300, epoch: 5 | loss: 0.0980290
	speed: 4.4602s/iter; left time: 3742.1497s
	iters: 400, epoch: 5 | loss: 0.1061974
	speed: 4.4899s/iter; left time: 3318.0191s
	iters: 500, epoch: 5 | loss: 0.1140087
	speed: 4.4401s/iter; left time: 2837.1956s
	iters: 600, epoch: 5 | loss: 0.1063726
	speed: 4.4174s/iter; left time: 2380.9671s
	iters: 700, epoch: 5 | loss: 0.1123378
	speed: 4.4289s/iter; left time: 1944.2752s
	iters: 800, epoch: 5 | loss: 0.0977023
	speed: 4.4149s/iter; left time: 1496.6571s
	iters: 900, epoch: 5 | loss: 0.1081534
	speed: 4.4609s/iter; left time: 1066.1483s
	iters: 1000, epoch: 5 | loss: 0.1191770
	speed: 4.4346s/iter; left time: 616.4120s
	iters: 1100, epoch: 5 | loss: 0.0998123
	speed: 4.4186s/iter; left time: 172.3248s
Epoch: 5 cost time: 5052.778886556625
Epoch: 5, Steps: 1138 | Train Loss: 0.1082270 Vali Loss: 0.1188866 Test Loss: 0.1390970
Validation loss decreased (0.119310 --> 0.118887).  Saving model ...
Updating learning rate to 6.25e-05
>>>>>>>testing : ECL_96_96_S_Mamba_custom_M_ft96_sl48_ll96_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 1, 96, 321) (5165, 1, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13909679651260376, mae:0.23674499988555908

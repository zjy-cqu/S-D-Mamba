Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_96', model='S_Mamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, enc_in=7, dec_in=7, c_out=7, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_96_S_Mamba_ETTm1_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3749609
	speed: 0.0298s/iter; left time: 316.8246s
	iters: 200, epoch: 1 | loss: 0.3504400
	speed: 0.0232s/iter; left time: 244.6019s
	iters: 300, epoch: 1 | loss: 0.3260361
	speed: 0.0226s/iter; left time: 236.4771s
	iters: 400, epoch: 1 | loss: 0.2930759
	speed: 0.0239s/iter; left time: 247.2637s
	iters: 500, epoch: 1 | loss: 0.2681361
	speed: 0.0245s/iter; left time: 251.2860s
	iters: 600, epoch: 1 | loss: 0.2949276
	speed: 0.0244s/iter; left time: 247.2091s
	iters: 700, epoch: 1 | loss: 0.2382136
	speed: 0.0242s/iter; left time: 243.3114s
	iters: 800, epoch: 1 | loss: 0.2663965
	speed: 0.0242s/iter; left time: 240.3344s
	iters: 900, epoch: 1 | loss: 0.2849489
	speed: 0.0240s/iter; left time: 235.7169s
	iters: 1000, epoch: 1 | loss: 0.2280149
	speed: 0.0238s/iter; left time: 232.2284s
Epoch: 1 cost time: 26.264469861984253
Epoch: 1, Steps: 1074 | Train Loss: 0.3290943 Vali Loss: 0.3949446 Test Loss: 0.3421443
Validation loss decreased (inf --> 0.394945).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.2480801
	speed: 0.5853s/iter; left time: 5599.2255s
	iters: 200, epoch: 2 | loss: 0.2661735
	speed: 0.0238s/iter; left time: 225.1349s
	iters: 300, epoch: 2 | loss: 0.3094318
	speed: 0.0237s/iter; left time: 222.3585s
	iters: 400, epoch: 2 | loss: 0.2921817
	speed: 0.0237s/iter; left time: 219.4661s
	iters: 500, epoch: 2 | loss: 0.2359950
	speed: 0.0237s/iter; left time: 217.4051s
	iters: 600, epoch: 2 | loss: 0.2527479
	speed: 0.0235s/iter; left time: 213.2171s
	iters: 700, epoch: 2 | loss: 0.2514331
	speed: 0.0234s/iter; left time: 210.2522s
	iters: 800, epoch: 2 | loss: 0.2594798
	speed: 0.0236s/iter; left time: 209.4695s
	iters: 900, epoch: 2 | loss: 0.2592162
	speed: 0.0236s/iter; left time: 207.2665s
	iters: 1000, epoch: 2 | loss: 0.2501053
	speed: 0.0234s/iter; left time: 203.1581s
Epoch: 2 cost time: 25.50027298927307
Epoch: 2, Steps: 1074 | Train Loss: 0.2704798 Vali Loss: 0.3900308 Test Loss: 0.3324651
Validation loss decreased (0.394945 --> 0.390031).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.3170884
	speed: 0.5576s/iter; left time: 4735.5837s
	iters: 200, epoch: 3 | loss: 0.2686075
	speed: 0.0248s/iter; left time: 208.0500s
	iters: 300, epoch: 3 | loss: 0.2791795
	speed: 0.0241s/iter; left time: 199.6282s
	iters: 400, epoch: 3 | loss: 0.2355824
	speed: 0.0265s/iter; left time: 216.8794s
	iters: 500, epoch: 3 | loss: 0.2313591
	speed: 0.0252s/iter; left time: 204.1691s
	iters: 600, epoch: 3 | loss: 0.2280631
	speed: 0.0225s/iter; left time: 179.6143s
	iters: 700, epoch: 3 | loss: 0.2134714
	speed: 0.0211s/iter; left time: 166.3268s
	iters: 800, epoch: 3 | loss: 0.2223151
	speed: 0.0251s/iter; left time: 195.6002s
	iters: 900, epoch: 3 | loss: 0.1709201
	speed: 0.0261s/iter; left time: 200.6215s
	iters: 1000, epoch: 3 | loss: 0.2842543
	speed: 0.0265s/iter; left time: 201.5892s
Epoch: 3 cost time: 26.57747745513916
Epoch: 3, Steps: 1074 | Train Loss: 0.2561425 Vali Loss: 0.3908610 Test Loss: 0.3300921
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.2648300
	speed: 0.5518s/iter; left time: 4094.0741s
	iters: 200, epoch: 4 | loss: 0.2512452
	speed: 0.0259s/iter; left time: 189.3026s
	iters: 300, epoch: 4 | loss: 0.2687850
	speed: 0.0250s/iter; left time: 180.1169s
	iters: 400, epoch: 4 | loss: 0.2197179
	speed: 0.0239s/iter; left time: 169.9020s
	iters: 500, epoch: 4 | loss: 0.2540475
	speed: 0.0224s/iter; left time: 156.9797s
	iters: 600, epoch: 4 | loss: 0.2433041
	speed: 0.0225s/iter; left time: 155.3344s
	iters: 700, epoch: 4 | loss: 0.2250844
	speed: 0.0259s/iter; left time: 176.7887s
	iters: 800, epoch: 4 | loss: 0.2821091
	speed: 0.0259s/iter; left time: 173.7016s
	iters: 900, epoch: 4 | loss: 0.2082385
	speed: 0.0259s/iter; left time: 171.7405s
	iters: 1000, epoch: 4 | loss: 0.2312104
	speed: 0.0258s/iter; left time: 168.1290s
Epoch: 4 cost time: 26.87285351753235
Epoch: 4, Steps: 1074 | Train Loss: 0.2501906 Vali Loss: 0.3925302 Test Loss: 0.3322526
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.2955081
	speed: 0.5686s/iter; left time: 3607.9833s
	iters: 200, epoch: 5 | loss: 0.2328690
	speed: 0.0256s/iter; left time: 160.0589s
	iters: 300, epoch: 5 | loss: 0.2180746
	speed: 0.0256s/iter; left time: 157.1065s
	iters: 400, epoch: 5 | loss: 0.2855160
	speed: 0.0257s/iter; left time: 155.0800s
	iters: 500, epoch: 5 | loss: 0.2967204
	speed: 0.0256s/iter; left time: 152.0262s
	iters: 600, epoch: 5 | loss: 0.2809640
	speed: 0.0255s/iter; left time: 149.2082s
	iters: 700, epoch: 5 | loss: 0.2041000
	speed: 0.0255s/iter; left time: 146.4116s
	iters: 800, epoch: 5 | loss: 0.2715878
	speed: 0.0252s/iter; left time: 142.2165s
	iters: 900, epoch: 5 | loss: 0.3069282
	speed: 0.0254s/iter; left time: 140.6464s
	iters: 1000, epoch: 5 | loss: 0.2306916
	speed: 0.0259s/iter; left time: 141.2492s
Epoch: 5 cost time: 27.563010215759277
Epoch: 5, Steps: 1074 | Train Loss: 0.2474652 Vali Loss: 0.3894913 Test Loss: 0.3307750
Validation loss decreased (0.390031 --> 0.389491).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.1956712
	speed: 0.5868s/iter; left time: 3093.0549s
	iters: 200, epoch: 6 | loss: 0.2587000
	speed: 0.0231s/iter; left time: 119.2565s
	iters: 300, epoch: 6 | loss: 0.2054521
	speed: 0.0235s/iter; left time: 119.3074s
	iters: 400, epoch: 6 | loss: 0.3027802
	speed: 0.0235s/iter; left time: 116.8548s
	iters: 500, epoch: 6 | loss: 0.2739542
	speed: 0.0236s/iter; left time: 114.7343s
	iters: 600, epoch: 6 | loss: 0.2964673
	speed: 0.0233s/iter; left time: 111.2163s
	iters: 700, epoch: 6 | loss: 0.2773554
	speed: 0.0235s/iter; left time: 109.5471s
	iters: 800, epoch: 6 | loss: 0.1926198
	speed: 0.0237s/iter; left time: 108.5540s
	iters: 900, epoch: 6 | loss: 0.2885634
	speed: 0.0258s/iter; left time: 115.3336s
	iters: 1000, epoch: 6 | loss: 0.2925411
	speed: 0.0258s/iter; left time: 112.6282s
Epoch: 6 cost time: 25.948540687561035
Epoch: 6, Steps: 1074 | Train Loss: 0.2459810 Vali Loss: 0.3893833 Test Loss: 0.3308254
Validation loss decreased (0.389491 --> 0.389383).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.2287419
	speed: 0.5382s/iter; left time: 2258.9987s
	iters: 200, epoch: 7 | loss: 0.2433812
	speed: 0.0260s/iter; left time: 106.5033s
	iters: 300, epoch: 7 | loss: 0.2758218
	speed: 0.0260s/iter; left time: 103.9721s
	iters: 400, epoch: 7 | loss: 0.2377188
	speed: 0.0260s/iter; left time: 101.3778s
	iters: 500, epoch: 7 | loss: 0.2415020
	speed: 0.0259s/iter; left time: 98.2025s
	iters: 600, epoch: 7 | loss: 0.2231815
	speed: 0.0256s/iter; left time: 94.5292s
	iters: 700, epoch: 7 | loss: 0.1870442
	speed: 0.0257s/iter; left time: 92.3052s
	iters: 800, epoch: 7 | loss: 0.2258994
	speed: 0.0258s/iter; left time: 90.2290s
	iters: 900, epoch: 7 | loss: 0.2846077
	speed: 0.0259s/iter; left time: 88.0720s
	iters: 1000, epoch: 7 | loss: 0.2300086
	speed: 0.0258s/iter; left time: 85.2242s
Epoch: 7 cost time: 27.881230115890503
Epoch: 7, Steps: 1074 | Train Loss: 0.2452809 Vali Loss: 0.3894511 Test Loss: 0.3308174
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.2222776
	speed: 0.5561s/iter; left time: 1736.6906s
	iters: 200, epoch: 8 | loss: 0.2437695
	speed: 0.0242s/iter; left time: 73.1812s
	iters: 300, epoch: 8 | loss: 0.2369951
	speed: 0.0258s/iter; left time: 75.5412s
	iters: 400, epoch: 8 | loss: 0.2182293
	speed: 0.0258s/iter; left time: 72.9367s
	iters: 500, epoch: 8 | loss: 0.2897060
	speed: 0.0258s/iter; left time: 70.3100s
	iters: 600, epoch: 8 | loss: 0.2209855
	speed: 0.0251s/iter; left time: 65.7725s
	iters: 700, epoch: 8 | loss: 0.2189593
	speed: 0.0256s/iter; left time: 64.6424s
	iters: 800, epoch: 8 | loss: 0.2667427
	speed: 0.0255s/iter; left time: 61.6722s
	iters: 900, epoch: 8 | loss: 0.2289662
	speed: 0.0244s/iter; left time: 56.6084s
	iters: 1000, epoch: 8 | loss: 0.3519067
	speed: 0.0231s/iter; left time: 51.2429s
Epoch: 8 cost time: 26.859142065048218
Epoch: 8, Steps: 1074 | Train Loss: 0.2449661 Vali Loss: 0.3891380 Test Loss: 0.3312529
Validation loss decreased (0.389383 --> 0.389138).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.2654687
	speed: 0.5659s/iter; left time: 1159.5106s
	iters: 200, epoch: 9 | loss: 0.2494874
	speed: 0.0247s/iter; left time: 48.1685s
	iters: 300, epoch: 9 | loss: 0.2440639
	speed: 0.0259s/iter; left time: 47.8346s
	iters: 400, epoch: 9 | loss: 0.2430650
	speed: 0.0256s/iter; left time: 44.7950s
	iters: 500, epoch: 9 | loss: 0.2919002
	speed: 0.0255s/iter; left time: 42.0566s
	iters: 600, epoch: 9 | loss: 0.2442243
	speed: 0.0254s/iter; left time: 39.3721s
	iters: 700, epoch: 9 | loss: 0.2234220
	speed: 0.0257s/iter; left time: 37.3076s
	iters: 800, epoch: 9 | loss: 0.1911020
	speed: 0.0256s/iter; left time: 34.5842s
	iters: 900, epoch: 9 | loss: 0.2162215
	speed: 0.0258s/iter; left time: 32.2117s
	iters: 1000, epoch: 9 | loss: 0.2995531
	speed: 0.0256s/iter; left time: 29.4115s
Epoch: 9 cost time: 27.525895357131958
Epoch: 9, Steps: 1074 | Train Loss: 0.2447638 Vali Loss: 0.3891676 Test Loss: 0.3310838
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.2551228
	speed: 0.5676s/iter; left time: 553.4265s
	iters: 200, epoch: 10 | loss: 0.2192061
	speed: 0.0226s/iter; left time: 19.7339s
	iters: 300, epoch: 10 | loss: 0.1735500
	speed: 0.0232s/iter; left time: 17.9856s
	iters: 400, epoch: 10 | loss: 0.2602676
	speed: 0.0226s/iter; left time: 15.2753s
	iters: 500, epoch: 10 | loss: 0.2144358
	speed: 0.0244s/iter; left time: 14.0094s
	iters: 600, epoch: 10 | loss: 0.2021640
	speed: 0.0256s/iter; left time: 12.1447s
	iters: 700, epoch: 10 | loss: 0.2139455
	speed: 0.0257s/iter; left time: 9.6194s
	iters: 800, epoch: 10 | loss: 0.2655997
	speed: 0.0254s/iter; left time: 6.9880s
	iters: 900, epoch: 10 | loss: 0.2157598
	speed: 0.0249s/iter; left time: 4.3637s
	iters: 1000, epoch: 10 | loss: 0.2483987
	speed: 0.0252s/iter; left time: 1.8897s
Epoch: 10 cost time: 26.354879140853882
Epoch: 10, Steps: 1074 | Train Loss: 0.2446391 Vali Loss: 0.3892375 Test Loss: 0.3311583
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
>>>>>>>testing : ETTm1_96_96_S_Mamba_ETTm1_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3312530517578125, mae:0.3677285313606262

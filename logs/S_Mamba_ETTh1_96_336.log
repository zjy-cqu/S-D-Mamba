Args in experiment:
Namespace(is_training=1, model_id='ETTh1_96_336', model='S_Mamba', data='ETTh1', root_path='./dataset/ETT-small/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_96_336_S_Mamba_ETTh1_M_ft96_sl48_ll336_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6577677
	speed: 0.0307s/iter; left time: 75.5922s
	iters: 200, epoch: 1 | loss: 0.5264720
	speed: 0.0179s/iter; left time: 42.2978s
Epoch: 1 cost time: 5.898867607116699
Epoch: 1, Steps: 256 | Train Loss: 0.5907176 Vali Loss: 1.3321416 Test Loss: 0.5142291
Validation loss decreased (inf --> 1.332142).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.5710041
	speed: 0.1761s/iter; left time: 388.4080s
	iters: 200, epoch: 2 | loss: 0.4688087
	speed: 0.0210s/iter; left time: 44.1344s
Epoch: 2 cost time: 6.105658054351807
Epoch: 2, Steps: 256 | Train Loss: 0.5104050 Vali Loss: 1.2972972 Test Loss: 0.4910356
Validation loss decreased (1.332142 --> 1.297297).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.5227264
	speed: 0.1538s/iter; left time: 299.7698s
	iters: 200, epoch: 3 | loss: 0.4101564
	speed: 0.0269s/iter; left time: 49.7221s
Epoch: 3 cost time: 7.189147233963013
Epoch: 3, Steps: 256 | Train Loss: 0.4934198 Vali Loss: 1.2943935 Test Loss: 0.4903353
Validation loss decreased (1.297297 --> 1.294394).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.4550252
	speed: 0.1752s/iter; left time: 296.6592s
	iters: 200, epoch: 4 | loss: 0.5236533
	speed: 0.0223s/iter; left time: 35.5910s
Epoch: 4 cost time: 6.144732236862183
Epoch: 4, Steps: 256 | Train Loss: 0.4862183 Vali Loss: 1.2910632 Test Loss: 0.4910395
Validation loss decreased (1.294394 --> 1.291063).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.4982812
	speed: 0.1748s/iter; left time: 251.2276s
	iters: 200, epoch: 5 | loss: 0.5047072
	speed: 0.0281s/iter; left time: 37.5336s
Epoch: 5 cost time: 7.289963006973267
Epoch: 5, Steps: 256 | Train Loss: 0.4828549 Vali Loss: 1.2859790 Test Loss: 0.4902058
Validation loss decreased (1.291063 --> 1.285979).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.4930427
	speed: 0.1674s/iter; left time: 197.6695s
	iters: 200, epoch: 6 | loss: 0.4982288
	speed: 0.0207s/iter; left time: 22.3366s
Epoch: 6 cost time: 5.803842782974243
Epoch: 6, Steps: 256 | Train Loss: 0.4808803 Vali Loss: 1.2892166 Test Loss: 0.4904320
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.4201653
	speed: 0.1550s/iter; left time: 143.3478s
	iters: 200, epoch: 7 | loss: 0.4728558
	speed: 0.0270s/iter; left time: 22.3019s
Epoch: 7 cost time: 6.899549245834351
Epoch: 7, Steps: 256 | Train Loss: 0.4804158 Vali Loss: 1.2863481 Test Loss: 0.4907633
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.4801396
	speed: 0.1671s/iter; left time: 111.8052s
	iters: 200, epoch: 8 | loss: 0.4560414
	speed: 0.0195s/iter; left time: 11.0844s
Epoch: 8 cost time: 5.515911340713501
Epoch: 8, Steps: 256 | Train Loss: 0.4799900 Vali Loss: 1.2882560 Test Loss: 0.4908796
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_96_336_S_Mamba_ETTh1_M_ft96_sl48_ll336_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4902060031890869, mae:0.4652855396270752

Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_720', model='iMamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_720_iMamba_ETTm1_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6221929
	speed: 0.0259s/iter; left time: 270.1490s
	iters: 200, epoch: 1 | loss: 0.5389293
	speed: 0.0195s/iter; left time: 201.3780s
	iters: 300, epoch: 1 | loss: 0.5176316
	speed: 0.0172s/iter; left time: 176.6059s
	iters: 400, epoch: 1 | loss: 0.6578485
	speed: 0.0172s/iter; left time: 174.2077s
	iters: 500, epoch: 1 | loss: 0.5577570
	speed: 0.0171s/iter; left time: 171.8670s
	iters: 600, epoch: 1 | loss: 0.5800001
	speed: 0.0160s/iter; left time: 159.5458s
	iters: 700, epoch: 1 | loss: 0.5999202
	speed: 0.0161s/iter; left time: 158.5592s
	iters: 800, epoch: 1 | loss: 0.5108536
	speed: 0.0190s/iter; left time: 185.4964s
	iters: 900, epoch: 1 | loss: 0.5305723
	speed: 0.0162s/iter; left time: 156.0929s
	iters: 1000, epoch: 1 | loss: 0.4805076
	speed: 0.0190s/iter; left time: 180.9153s
Epoch: 1 cost time: 19.29671812057495
Epoch: 1, Steps: 1054 | Train Loss: 0.5508018 Vali Loss: 1.0233002 Test Loss: 0.5118481
Validation loss decreased (inf --> 1.023300).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.5013605
	speed: 1.4758s/iter; left time: 13853.7205s
	iters: 200, epoch: 2 | loss: 0.5810624
	speed: 0.0200s/iter; left time: 185.8772s
	iters: 300, epoch: 2 | loss: 0.4842944
	speed: 0.0208s/iter; left time: 190.8899s
	iters: 400, epoch: 2 | loss: 0.4444983
	speed: 0.0195s/iter; left time: 176.9708s
	iters: 500, epoch: 2 | loss: 0.5210776
	speed: 0.0192s/iter; left time: 172.3329s
	iters: 600, epoch: 2 | loss: 0.4896723
	speed: 0.0201s/iter; left time: 178.6901s
	iters: 700, epoch: 2 | loss: 0.3785218
	speed: 0.0187s/iter; left time: 164.4125s
	iters: 800, epoch: 2 | loss: 0.4296560
	speed: 0.0163s/iter; left time: 141.7090s
	iters: 900, epoch: 2 | loss: 0.4720871
	speed: 0.0167s/iter; left time: 143.2495s
	iters: 1000, epoch: 2 | loss: 0.5183389
	speed: 0.0187s/iter; left time: 159.0842s
Epoch: 2 cost time: 20.458940744400024
Epoch: 2, Steps: 1054 | Train Loss: 0.4839628 Vali Loss: 0.9872145 Test Loss: 0.4864757
Validation loss decreased (1.023300 --> 0.987215).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.4643635
	speed: 1.5124s/iter; left time: 12603.0646s
	iters: 200, epoch: 3 | loss: 0.5570242
	speed: 0.0201s/iter; left time: 165.4747s
	iters: 300, epoch: 3 | loss: 0.5086298
	speed: 0.0200s/iter; left time: 162.5619s
	iters: 400, epoch: 3 | loss: 0.5138381
	speed: 0.0166s/iter; left time: 133.2755s
	iters: 500, epoch: 3 | loss: 0.3550730
	speed: 0.0162s/iter; left time: 128.5299s
	iters: 600, epoch: 3 | loss: 0.4495966
	speed: 0.0159s/iter; left time: 124.9051s
	iters: 700, epoch: 3 | loss: 0.4519487
	speed: 0.0160s/iter; left time: 123.8579s
	iters: 800, epoch: 3 | loss: 0.3926327
	speed: 0.0169s/iter; left time: 128.9829s
	iters: 900, epoch: 3 | loss: 0.4638977
	speed: 0.0206s/iter; left time: 155.2961s
	iters: 1000, epoch: 3 | loss: 0.4932943
	speed: 0.0202s/iter; left time: 150.4498s
Epoch: 3 cost time: 19.98760986328125
Epoch: 3, Steps: 1054 | Train Loss: 0.4699727 Vali Loss: 0.9838168 Test Loss: 0.4827833
Validation loss decreased (0.987215 --> 0.983817).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.3822904
	speed: 1.5601s/iter; left time: 11356.3000s
	iters: 200, epoch: 4 | loss: 0.5682177
	speed: 0.0194s/iter; left time: 139.5351s
	iters: 300, epoch: 4 | loss: 0.3671679
	speed: 0.0188s/iter; left time: 132.9427s
	iters: 400, epoch: 4 | loss: 0.5029466
	speed: 0.0180s/iter; left time: 125.7365s
	iters: 500, epoch: 4 | loss: 0.3880610
	speed: 0.0189s/iter; left time: 129.9556s
	iters: 600, epoch: 4 | loss: 0.4779321
	speed: 0.0190s/iter; left time: 128.7039s
	iters: 700, epoch: 4 | loss: 0.5988920
	speed: 0.0188s/iter; left time: 125.3621s
	iters: 800, epoch: 4 | loss: 0.5678706
	speed: 0.0174s/iter; left time: 114.6183s
	iters: 900, epoch: 4 | loss: 0.4150707
	speed: 0.0176s/iter; left time: 114.1413s
	iters: 1000, epoch: 4 | loss: 0.4987063
	speed: 0.0203s/iter; left time: 129.3829s
Epoch: 4 cost time: 20.07295298576355
Epoch: 4, Steps: 1054 | Train Loss: 0.4657617 Vali Loss: 0.9813970 Test Loss: 0.4813761
Validation loss decreased (0.983817 --> 0.981397).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.4873805
	speed: 1.4843s/iter; left time: 9239.5937s
	iters: 200, epoch: 5 | loss: 0.5292724
	speed: 0.0209s/iter; left time: 127.8291s
	iters: 300, epoch: 5 | loss: 0.4678514
	speed: 0.0213s/iter; left time: 128.4867s
	iters: 400, epoch: 5 | loss: 0.5470302
	speed: 0.0208s/iter; left time: 123.4668s
	iters: 500, epoch: 5 | loss: 0.5638129
	speed: 0.0217s/iter; left time: 126.4310s
	iters: 600, epoch: 5 | loss: 0.4567722
	speed: 0.0225s/iter; left time: 128.5340s
	iters: 700, epoch: 5 | loss: 0.4557640
	speed: 0.0213s/iter; left time: 119.5326s
	iters: 800, epoch: 5 | loss: 0.4884595
	speed: 0.0302s/iter; left time: 167.0922s
	iters: 900, epoch: 5 | loss: 0.4228822
	speed: 0.0335s/iter; left time: 181.9362s
	iters: 1000, epoch: 5 | loss: 0.4249333
	speed: 0.0316s/iter; left time: 168.4820s
Epoch: 5 cost time: 26.440702438354492
Epoch: 5, Steps: 1054 | Train Loss: 0.4638302 Vali Loss: 0.9803535 Test Loss: 0.4810527
Validation loss decreased (0.981397 --> 0.980354).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.4665897
	speed: 1.6485s/iter; left time: 8524.5774s
	iters: 200, epoch: 6 | loss: 0.4849679
	speed: 0.0191s/iter; left time: 96.9320s
	iters: 300, epoch: 6 | loss: 0.5926025
	speed: 0.0208s/iter; left time: 103.6030s
	iters: 400, epoch: 6 | loss: 0.5661979
	speed: 0.0209s/iter; left time: 101.8907s
	iters: 500, epoch: 6 | loss: 0.4989495
	speed: 0.0167s/iter; left time: 79.6727s
	iters: 600, epoch: 6 | loss: 0.4560362
	speed: 0.0198s/iter; left time: 92.3386s
	iters: 700, epoch: 6 | loss: 0.4458198
	speed: 0.0167s/iter; left time: 76.1710s
	iters: 800, epoch: 6 | loss: 0.4985632
	speed: 0.0186s/iter; left time: 82.9589s
	iters: 900, epoch: 6 | loss: 0.4608186
	speed: 0.0323s/iter; left time: 141.2498s
	iters: 1000, epoch: 6 | loss: 0.5591644
	speed: 0.0304s/iter; left time: 129.9817s
Epoch: 6 cost time: 23.45651364326477
Epoch: 6, Steps: 1054 | Train Loss: 0.4629390 Vali Loss: 0.9796748 Test Loss: 0.4808224
Validation loss decreased (0.980354 --> 0.979675).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.4577282
	speed: 1.6284s/iter; left time: 6704.0894s
	iters: 200, epoch: 7 | loss: 0.4625803
	speed: 0.0165s/iter; left time: 66.2414s
	iters: 300, epoch: 7 | loss: 0.5373403
	speed: 0.0159s/iter; left time: 62.4689s
	iters: 400, epoch: 7 | loss: 0.5529601
	speed: 0.0163s/iter; left time: 62.2423s
	iters: 500, epoch: 7 | loss: 0.5045450
	speed: 0.0161s/iter; left time: 59.6934s
	iters: 600, epoch: 7 | loss: 0.4761269
	speed: 0.0160s/iter; left time: 57.7655s
	iters: 700, epoch: 7 | loss: 0.4918149
	speed: 0.0190s/iter; left time: 66.7866s
	iters: 800, epoch: 7 | loss: 0.4853091
	speed: 0.0205s/iter; left time: 69.9848s
	iters: 900, epoch: 7 | loss: 0.4306997
	speed: 0.0198s/iter; left time: 65.8395s
	iters: 1000, epoch: 7 | loss: 0.4339558
	speed: 0.0203s/iter; left time: 65.4658s
Epoch: 7 cost time: 18.963102340698242
Epoch: 7, Steps: 1054 | Train Loss: 0.4624973 Vali Loss: 0.9795762 Test Loss: 0.4807582
Validation loss decreased (0.979675 --> 0.979576).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.4583365
	speed: 1.5084s/iter; left time: 4620.2277s
	iters: 200, epoch: 8 | loss: 0.5092369
	speed: 0.0176s/iter; left time: 52.1573s
	iters: 300, epoch: 8 | loss: 0.4344983
	speed: 0.0191s/iter; left time: 54.7552s
	iters: 400, epoch: 8 | loss: 0.4952782
	speed: 0.0161s/iter; left time: 44.3538s
	iters: 500, epoch: 8 | loss: 0.4748366
	speed: 0.0162s/iter; left time: 43.1838s
	iters: 600, epoch: 8 | loss: 0.5120993
	speed: 0.0159s/iter; left time: 40.7476s
	iters: 700, epoch: 8 | loss: 0.4225304
	speed: 0.0161s/iter; left time: 39.5764s
	iters: 800, epoch: 8 | loss: 0.3985595
	speed: 0.0162s/iter; left time: 38.3485s
	iters: 900, epoch: 8 | loss: 0.4325727
	speed: 0.0159s/iter; left time: 36.0845s
	iters: 1000, epoch: 8 | loss: 0.4081956
	speed: 0.0165s/iter; left time: 35.5965s
Epoch: 8 cost time: 18.395923614501953
Epoch: 8, Steps: 1054 | Train Loss: 0.4623455 Vali Loss: 0.9802449 Test Loss: 0.4807247
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.4177707
	speed: 1.4942s/iter; left time: 3001.9051s
	iters: 200, epoch: 9 | loss: 0.4602141
	speed: 0.0156s/iter; left time: 29.8573s
	iters: 300, epoch: 9 | loss: 0.5886323
	speed: 0.0190s/iter; left time: 34.3814s
	iters: 400, epoch: 9 | loss: 0.4512489
	speed: 0.0186s/iter; left time: 31.7781s
	iters: 500, epoch: 9 | loss: 0.4485533
	speed: 0.0191s/iter; left time: 30.6894s
	iters: 600, epoch: 9 | loss: 0.4238798
	speed: 0.0160s/iter; left time: 24.0825s
	iters: 700, epoch: 9 | loss: 0.4246860
	speed: 0.0161s/iter; left time: 22.7074s
	iters: 800, epoch: 9 | loss: 0.4560444
	speed: 0.0183s/iter; left time: 23.9667s
	iters: 900, epoch: 9 | loss: 0.3991067
	speed: 0.0160s/iter; left time: 19.3271s
	iters: 1000, epoch: 9 | loss: 0.4856971
	speed: 0.0184s/iter; left time: 20.3984s
Epoch: 9 cost time: 18.519221544265747
Epoch: 9, Steps: 1054 | Train Loss: 0.4621816 Vali Loss: 0.9802516 Test Loss: 0.4807215
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.5228624
	speed: 1.5232s/iter; left time: 1454.6739s
	iters: 200, epoch: 10 | loss: 0.4667699
	speed: 0.0160s/iter; left time: 13.7032s
	iters: 300, epoch: 10 | loss: 0.4045972
	speed: 0.0181s/iter; left time: 13.6404s
	iters: 400, epoch: 10 | loss: 0.4720071
	speed: 0.0161s/iter; left time: 10.5389s
	iters: 500, epoch: 10 | loss: 0.4413736
	speed: 0.0160s/iter; left time: 8.8617s
	iters: 600, epoch: 10 | loss: 0.4931156
	speed: 0.0169s/iter; left time: 7.6947s
	iters: 700, epoch: 10 | loss: 0.5419323
	speed: 0.0162s/iter; left time: 5.7544s
	iters: 800, epoch: 10 | loss: 0.3922771
	speed: 0.0173s/iter; left time: 4.4194s
	iters: 900, epoch: 10 | loss: 0.4704712
	speed: 0.0197s/iter; left time: 3.0537s
	iters: 1000, epoch: 10 | loss: 0.4354894
	speed: 0.0204s/iter; left time: 1.1223s
Epoch: 10 cost time: 18.68467378616333
Epoch: 10, Steps: 1054 | Train Loss: 0.4620567 Vali Loss: 0.9798528 Test Loss: 0.4807169
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_720_iMamba_ETTm1_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.48075732588768005, mae:0.45450645685195923

Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_96', model='iMamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, enc_in=7, dec_in=7, c_out=7, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_96_iMamba_ETTm1_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3811086
	speed: 0.0264s/iter; left time: 280.9618s
	iters: 200, epoch: 1 | loss: 0.3723469
	speed: 0.0204s/iter; left time: 215.4036s
	iters: 300, epoch: 1 | loss: 0.3368358
	speed: 0.0205s/iter; left time: 214.1596s
	iters: 400, epoch: 1 | loss: 0.3667178
	speed: 0.0206s/iter; left time: 213.3473s
	iters: 500, epoch: 1 | loss: 0.3444331
	speed: 0.0212s/iter; left time: 216.7632s
	iters: 600, epoch: 1 | loss: 0.2953601
	speed: 0.0210s/iter; left time: 212.9337s
	iters: 700, epoch: 1 | loss: 0.3254482
	speed: 0.0207s/iter; left time: 207.3671s
	iters: 800, epoch: 1 | loss: 0.2710125
	speed: 0.0210s/iter; left time: 208.4743s
	iters: 900, epoch: 1 | loss: 0.2684923
	speed: 0.0209s/iter; left time: 205.8935s
	iters: 1000, epoch: 1 | loss: 0.3224409
	speed: 0.0209s/iter; left time: 203.7725s
Epoch: 1 cost time: 22.956323862075806
Epoch: 1, Steps: 1074 | Train Loss: 0.3471906 Vali Loss: 0.3987201 Test Loss: 0.3441060
Validation loss decreased (inf --> 0.398720).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.2371209
	speed: 1.5473s/iter; left time: 14802.9937s
	iters: 200, epoch: 2 | loss: 0.2890372
	speed: 0.0202s/iter; left time: 191.3430s
	iters: 300, epoch: 2 | loss: 0.3392721
	speed: 0.0208s/iter; left time: 194.8294s
	iters: 400, epoch: 2 | loss: 0.2770665
	speed: 0.0208s/iter; left time: 192.4922s
	iters: 500, epoch: 2 | loss: 0.2796942
	speed: 0.0204s/iter; left time: 187.2747s
	iters: 600, epoch: 2 | loss: 0.2928385
	speed: 0.0210s/iter; left time: 190.8266s
	iters: 700, epoch: 2 | loss: 0.3365988
	speed: 0.0208s/iter; left time: 186.2632s
	iters: 800, epoch: 2 | loss: 0.2584580
	speed: 0.0209s/iter; left time: 185.5102s
	iters: 900, epoch: 2 | loss: 0.2821782
	speed: 0.0205s/iter; left time: 179.7660s
	iters: 1000, epoch: 2 | loss: 0.2692459
	speed: 0.0207s/iter; left time: 179.8087s
Epoch: 2 cost time: 22.44070053100586
Epoch: 2, Steps: 1074 | Train Loss: 0.2818030 Vali Loss: 0.3939446 Test Loss: 0.3347275
Validation loss decreased (0.398720 --> 0.393945).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.2338531
	speed: 1.5600s/iter; left time: 13249.4870s
	iters: 200, epoch: 3 | loss: 0.2607680
	speed: 0.0212s/iter; left time: 178.2823s
	iters: 300, epoch: 3 | loss: 0.2846651
	speed: 0.0207s/iter; left time: 171.6569s
	iters: 400, epoch: 3 | loss: 0.2367539
	speed: 0.0214s/iter; left time: 175.5481s
	iters: 500, epoch: 3 | loss: 0.2351869
	speed: 0.0209s/iter; left time: 169.1099s
	iters: 600, epoch: 3 | loss: 0.2336671
	speed: 0.0210s/iter; left time: 167.6364s
	iters: 700, epoch: 3 | loss: 0.2856787
	speed: 0.0206s/iter; left time: 162.2065s
	iters: 800, epoch: 3 | loss: 0.1997715
	speed: 0.0210s/iter; left time: 163.4178s
	iters: 900, epoch: 3 | loss: 0.2098070
	speed: 0.0211s/iter; left time: 162.6566s
	iters: 1000, epoch: 3 | loss: 0.2872678
	speed: 0.0209s/iter; left time: 159.0172s
Epoch: 3 cost time: 22.737337112426758
Epoch: 3, Steps: 1074 | Train Loss: 0.2669752 Vali Loss: 0.3917446 Test Loss: 0.3315840
Validation loss decreased (0.393945 --> 0.391745).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.2018655
	speed: 1.5412s/iter; left time: 11434.4630s
	iters: 200, epoch: 4 | loss: 0.2351372
	speed: 0.0204s/iter; left time: 149.6715s
	iters: 300, epoch: 4 | loss: 0.3135554
	speed: 0.0197s/iter; left time: 141.9194s
	iters: 400, epoch: 4 | loss: 0.2925993
	speed: 0.0196s/iter; left time: 139.6250s
	iters: 500, epoch: 4 | loss: 0.2487404
	speed: 0.0198s/iter; left time: 139.0452s
	iters: 600, epoch: 4 | loss: 0.3429325
	speed: 0.0203s/iter; left time: 140.6073s
	iters: 700, epoch: 4 | loss: 0.2875868
	speed: 0.0195s/iter; left time: 133.2246s
	iters: 800, epoch: 4 | loss: 0.3018331
	speed: 0.0193s/iter; left time: 129.6221s
	iters: 900, epoch: 4 | loss: 0.2223988
	speed: 0.0194s/iter; left time: 128.6296s
	iters: 1000, epoch: 4 | loss: 0.2329774
	speed: 0.0195s/iter; left time: 126.8682s
Epoch: 4 cost time: 21.349344730377197
Epoch: 4, Steps: 1074 | Train Loss: 0.2615089 Vali Loss: 0.3903637 Test Loss: 0.3311681
Validation loss decreased (0.391745 --> 0.390364).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.2771633
	speed: 1.5588s/iter; left time: 9890.6900s
	iters: 200, epoch: 5 | loss: 0.2593671
	speed: 0.0214s/iter; left time: 133.6660s
	iters: 300, epoch: 5 | loss: 0.2270389
	speed: 0.0210s/iter; left time: 128.9707s
	iters: 400, epoch: 5 | loss: 0.2884732
	speed: 0.0212s/iter; left time: 128.3877s
	iters: 500, epoch: 5 | loss: 0.2249448
	speed: 0.0211s/iter; left time: 125.5161s
	iters: 600, epoch: 5 | loss: 0.2099946
	speed: 0.0210s/iter; left time: 123.0177s
	iters: 700, epoch: 5 | loss: 0.2347429
	speed: 0.0212s/iter; left time: 121.8819s
	iters: 800, epoch: 5 | loss: 0.2792983
	speed: 0.0212s/iter; left time: 119.8967s
	iters: 900, epoch: 5 | loss: 0.2988120
	speed: 0.0210s/iter; left time: 116.2700s
	iters: 1000, epoch: 5 | loss: 0.1959665
	speed: 0.0205s/iter; left time: 111.7723s
Epoch: 5 cost time: 22.839876890182495
Epoch: 5, Steps: 1074 | Train Loss: 0.2588937 Vali Loss: 0.3895659 Test Loss: 0.3299979
Validation loss decreased (0.390364 --> 0.389566).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.2597765
	speed: 1.5342s/iter; left time: 8086.9365s
	iters: 200, epoch: 6 | loss: 0.3011128
	speed: 0.0161s/iter; left time: 83.2371s
	iters: 300, epoch: 6 | loss: 0.2540011
	speed: 0.0194s/iter; left time: 98.2023s
	iters: 400, epoch: 6 | loss: 0.2728812
	speed: 0.0202s/iter; left time: 100.4698s
	iters: 500, epoch: 6 | loss: 0.2616231
	speed: 0.0204s/iter; left time: 99.1773s
	iters: 600, epoch: 6 | loss: 0.2253254
	speed: 0.0204s/iter; left time: 97.5142s
	iters: 700, epoch: 6 | loss: 0.2521300
	speed: 0.0186s/iter; left time: 87.0483s
	iters: 800, epoch: 6 | loss: 0.3077521
	speed: 0.0207s/iter; left time: 94.5234s
	iters: 900, epoch: 6 | loss: 0.2955683
	speed: 0.0217s/iter; left time: 97.0958s
	iters: 1000, epoch: 6 | loss: 0.2901831
	speed: 0.0210s/iter; left time: 91.6694s
Epoch: 6 cost time: 21.24018621444702
Epoch: 6, Steps: 1074 | Train Loss: 0.2577813 Vali Loss: 0.3890128 Test Loss: 0.3299173
Validation loss decreased (0.389566 --> 0.389013).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.2118386
	speed: 1.5880s/iter; left time: 6664.8455s
	iters: 200, epoch: 7 | loss: 0.2455553
	speed: 0.0207s/iter; left time: 84.8222s
	iters: 300, epoch: 7 | loss: 0.2939363
	speed: 0.0207s/iter; left time: 82.8381s
	iters: 400, epoch: 7 | loss: 0.2310395
	speed: 0.0210s/iter; left time: 81.7375s
	iters: 500, epoch: 7 | loss: 0.2280538
	speed: 0.0208s/iter; left time: 79.0617s
	iters: 600, epoch: 7 | loss: 0.2266813
	speed: 0.0213s/iter; left time: 78.8139s
	iters: 700, epoch: 7 | loss: 0.2781726
	speed: 0.0218s/iter; left time: 78.3717s
	iters: 800, epoch: 7 | loss: 0.2651320
	speed: 0.0219s/iter; left time: 76.4381s
	iters: 900, epoch: 7 | loss: 0.2508643
	speed: 0.0218s/iter; left time: 73.9727s
	iters: 1000, epoch: 7 | loss: 0.2592369
	speed: 0.0219s/iter; left time: 72.1574s
Epoch: 7 cost time: 23.06730341911316
Epoch: 7, Steps: 1074 | Train Loss: 0.2571669 Vali Loss: 0.3886955 Test Loss: 0.3293574
Validation loss decreased (0.389013 --> 0.388695).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.2937968
	speed: 1.7741s/iter; left time: 5540.4126s
	iters: 200, epoch: 8 | loss: 0.1792639
	speed: 0.0221s/iter; left time: 66.9123s
	iters: 300, epoch: 8 | loss: 0.2253912
	speed: 0.0219s/iter; left time: 64.0720s
	iters: 400, epoch: 8 | loss: 0.2856970
	speed: 0.0213s/iter; left time: 60.0750s
	iters: 500, epoch: 8 | loss: 0.2893607
	speed: 0.0212s/iter; left time: 57.8220s
	iters: 600, epoch: 8 | loss: 0.3250637
	speed: 0.0214s/iter; left time: 56.1003s
	iters: 700, epoch: 8 | loss: 0.2052227
	speed: 0.0213s/iter; left time: 53.8350s
	iters: 800, epoch: 8 | loss: 0.2671643
	speed: 0.0217s/iter; left time: 52.6502s
	iters: 900, epoch: 8 | loss: 0.2728342
	speed: 0.0216s/iter; left time: 50.1432s
	iters: 1000, epoch: 8 | loss: 0.2084616
	speed: 0.0213s/iter; left time: 47.3939s
Epoch: 8 cost time: 23.547338485717773
Epoch: 8, Steps: 1074 | Train Loss: 0.2567787 Vali Loss: 0.3888829 Test Loss: 0.3294708
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.2538889
	speed: 1.7642s/iter; left time: 3614.8052s
	iters: 200, epoch: 9 | loss: 0.2610019
	speed: 0.0210s/iter; left time: 40.9923s
	iters: 300, epoch: 9 | loss: 0.2819579
	speed: 0.0212s/iter; left time: 39.1248s
	iters: 400, epoch: 9 | loss: 0.2465626
	speed: 0.0208s/iter; left time: 36.3029s
	iters: 500, epoch: 9 | loss: 0.2395286
	speed: 0.0206s/iter; left time: 34.0136s
	iters: 600, epoch: 9 | loss: 0.2920625
	speed: 0.0205s/iter; left time: 31.8122s
	iters: 700, epoch: 9 | loss: 0.2766362
	speed: 0.0222s/iter; left time: 32.0980s
	iters: 800, epoch: 9 | loss: 0.2459406
	speed: 0.0226s/iter; left time: 30.4529s
	iters: 900, epoch: 9 | loss: 0.2846437
	speed: 0.0220s/iter; left time: 27.5329s
	iters: 1000, epoch: 9 | loss: 0.2598919
	speed: 0.0218s/iter; left time: 25.0119s
Epoch: 9 cost time: 23.223561763763428
Epoch: 9, Steps: 1074 | Train Loss: 0.2566641 Vali Loss: 0.3888713 Test Loss: 0.3294882
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.2621483
	speed: 1.7706s/iter; left time: 1726.3811s
	iters: 200, epoch: 10 | loss: 0.2542867
	speed: 0.0202s/iter; left time: 17.7041s
	iters: 300, epoch: 10 | loss: 0.2925216
	speed: 0.0202s/iter; left time: 15.6525s
	iters: 400, epoch: 10 | loss: 0.2232942
	speed: 0.0202s/iter; left time: 13.6573s
	iters: 500, epoch: 10 | loss: 0.2730293
	speed: 0.0202s/iter; left time: 11.6229s
	iters: 600, epoch: 10 | loss: 0.2020430
	speed: 0.0202s/iter; left time: 9.5927s
	iters: 700, epoch: 10 | loss: 0.2437041
	speed: 0.0204s/iter; left time: 7.6313s
	iters: 800, epoch: 10 | loss: 0.2427093
	speed: 0.0202s/iter; left time: 5.5645s
	iters: 900, epoch: 10 | loss: 0.2755925
	speed: 0.0207s/iter; left time: 3.6211s
	iters: 1000, epoch: 10 | loss: 0.2042171
	speed: 0.0206s/iter; left time: 1.5471s
Epoch: 10 cost time: 22.062164783477783
Epoch: 10, Steps: 1074 | Train Loss: 0.2567882 Vali Loss: 0.3888796 Test Loss: 0.3294942
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_96_iMamba_ETTm1_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.32935744524002075, mae:0.36663350462913513

Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_192', model='iMamba', data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_192_iMamba_ETTm1_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4664525
	speed: 0.0218s/iter; left time: 231.7609s
	iters: 200, epoch: 1 | loss: 0.4805442
	speed: 0.0165s/iter; left time: 173.2417s
	iters: 300, epoch: 1 | loss: 0.5136491
	speed: 0.0142s/iter; left time: 147.4721s
	iters: 400, epoch: 1 | loss: 0.3766663
	speed: 0.0146s/iter; left time: 150.4790s
	iters: 500, epoch: 1 | loss: 0.3846246
	speed: 0.0151s/iter; left time: 154.2776s
	iters: 600, epoch: 1 | loss: 0.3425019
	speed: 0.0160s/iter; left time: 161.9659s
	iters: 700, epoch: 1 | loss: 0.3799644
	speed: 0.0142s/iter; left time: 141.7975s
	iters: 800, epoch: 1 | loss: 0.3932001
	speed: 0.0132s/iter; left time: 130.6030s
	iters: 900, epoch: 1 | loss: 0.3553029
	speed: 0.0131s/iter; left time: 129.0095s
	iters: 1000, epoch: 1 | loss: 0.3973875
	speed: 0.0128s/iter; left time: 123.8498s
Epoch: 1 cost time: 16.10786724090576
Epoch: 1, Steps: 1071 | Train Loss: 0.4212080 Vali Loss: 0.5418074 Test Loss: 0.4086810
Validation loss decreased (inf --> 0.541807).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.3210424
	speed: 0.4321s/iter; left time: 4122.2604s
	iters: 200, epoch: 2 | loss: 0.4005672
	speed: 0.0158s/iter; left time: 149.4002s
	iters: 300, epoch: 2 | loss: 0.3103351
	speed: 0.0161s/iter; left time: 150.5106s
	iters: 400, epoch: 2 | loss: 0.3492924
	speed: 0.0161s/iter; left time: 149.0268s
	iters: 500, epoch: 2 | loss: 0.3551305
	speed: 0.0148s/iter; left time: 135.3656s
	iters: 600, epoch: 2 | loss: 0.3605977
	speed: 0.0149s/iter; left time: 134.7881s
	iters: 700, epoch: 2 | loss: 0.2752410
	speed: 0.0147s/iter; left time: 131.4488s
	iters: 800, epoch: 2 | loss: 0.3525354
	speed: 0.0146s/iter; left time: 128.6413s
	iters: 900, epoch: 2 | loss: 0.2881922
	speed: 0.0150s/iter; left time: 130.7916s
	iters: 1000, epoch: 2 | loss: 0.3268312
	speed: 0.0145s/iter; left time: 125.4722s
Epoch: 2 cost time: 16.467138051986694
Epoch: 2, Steps: 1071 | Train Loss: 0.3549423 Vali Loss: 0.5191464 Test Loss: 0.3900308
Validation loss decreased (0.541807 --> 0.519146).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.3091484
	speed: 0.4011s/iter; left time: 3396.4956s
	iters: 200, epoch: 3 | loss: 0.2794670
	speed: 0.0161s/iter; left time: 134.6813s
	iters: 300, epoch: 3 | loss: 0.3984800
	speed: 0.0152s/iter; left time: 125.2989s
	iters: 400, epoch: 3 | loss: 0.3229184
	speed: 0.0154s/iter; left time: 125.9450s
	iters: 500, epoch: 3 | loss: 0.3024347
	speed: 0.0155s/iter; left time: 125.3456s
	iters: 600, epoch: 3 | loss: 0.3439347
	speed: 0.0159s/iter; left time: 126.4883s
	iters: 700, epoch: 3 | loss: 0.3107715
	speed: 0.0160s/iter; left time: 126.1146s
	iters: 800, epoch: 3 | loss: 0.3972667
	speed: 0.0151s/iter; left time: 117.4100s
	iters: 900, epoch: 3 | loss: 0.3022624
	speed: 0.0161s/iter; left time: 123.4301s
	iters: 1000, epoch: 3 | loss: 0.3014011
	speed: 0.0153s/iter; left time: 115.7105s
Epoch: 3 cost time: 16.902311325073242
Epoch: 3, Steps: 1071 | Train Loss: 0.3413254 Vali Loss: 0.5152246 Test Loss: 0.3856762
Validation loss decreased (0.519146 --> 0.515225).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.4212013
	speed: 0.3817s/iter; left time: 2824.1787s
	iters: 200, epoch: 4 | loss: 0.3401694
	speed: 0.0119s/iter; left time: 86.6656s
	iters: 300, epoch: 4 | loss: 0.3495983
	speed: 0.0141s/iter; left time: 101.3259s
	iters: 400, epoch: 4 | loss: 0.3082992
	speed: 0.0132s/iter; left time: 93.9039s
	iters: 500, epoch: 4 | loss: 0.3869680
	speed: 0.0133s/iter; left time: 93.0830s
	iters: 600, epoch: 4 | loss: 0.3104436
	speed: 0.0119s/iter; left time: 82.2828s
	iters: 700, epoch: 4 | loss: 0.3547762
	speed: 0.0114s/iter; left time: 77.2730s
	iters: 800, epoch: 4 | loss: 0.3752757
	speed: 0.0113s/iter; left time: 76.0013s
	iters: 900, epoch: 4 | loss: 0.3021562
	speed: 0.0113s/iter; left time: 74.8239s
	iters: 1000, epoch: 4 | loss: 0.2855344
	speed: 0.0113s/iter; left time: 73.2917s
Epoch: 4 cost time: 13.135529041290283
Epoch: 4, Steps: 1071 | Train Loss: 0.3365254 Vali Loss: 0.5138505 Test Loss: 0.3840956
Validation loss decreased (0.515225 --> 0.513851).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.2925721
	speed: 0.3957s/iter; left time: 2503.5314s
	iters: 200, epoch: 5 | loss: 0.3262786
	speed: 0.0130s/iter; left time: 81.2321s
	iters: 300, epoch: 5 | loss: 0.2887194
	speed: 0.0131s/iter; left time: 79.9663s
	iters: 400, epoch: 5 | loss: 0.4508787
	speed: 0.0130s/iter; left time: 78.1677s
	iters: 500, epoch: 5 | loss: 0.3687165
	speed: 0.0124s/iter; left time: 73.2691s
	iters: 600, epoch: 5 | loss: 0.3307049
	speed: 0.0120s/iter; left time: 69.9175s
	iters: 700, epoch: 5 | loss: 0.3516456
	speed: 0.0120s/iter; left time: 68.9491s
	iters: 800, epoch: 5 | loss: 0.3023394
	speed: 0.0110s/iter; left time: 61.6659s
	iters: 900, epoch: 5 | loss: 0.3233175
	speed: 0.0118s/iter; left time: 65.1634s
	iters: 1000, epoch: 5 | loss: 0.3251613
	speed: 0.0119s/iter; left time: 64.7429s
Epoch: 5 cost time: 13.455916166305542
Epoch: 5, Steps: 1071 | Train Loss: 0.3344257 Vali Loss: 0.5138748 Test Loss: 0.3834192
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.3055263
	speed: 0.3670s/iter; left time: 1929.1414s
	iters: 200, epoch: 6 | loss: 0.3295988
	speed: 0.0152s/iter; left time: 78.1858s
	iters: 300, epoch: 6 | loss: 0.3023603
	speed: 0.0137s/iter; left time: 69.0169s
	iters: 400, epoch: 6 | loss: 0.3983805
	speed: 0.0135s/iter; left time: 66.7372s
	iters: 500, epoch: 6 | loss: 0.4277569
	speed: 0.0144s/iter; left time: 69.9302s
	iters: 600, epoch: 6 | loss: 0.3312455
	speed: 0.0141s/iter; left time: 67.2418s
	iters: 700, epoch: 6 | loss: 0.3355241
	speed: 0.0153s/iter; left time: 71.1951s
	iters: 800, epoch: 6 | loss: 0.3112209
	speed: 0.0142s/iter; left time: 64.6796s
	iters: 900, epoch: 6 | loss: 0.2872385
	speed: 0.0142s/iter; left time: 63.3980s
	iters: 1000, epoch: 6 | loss: 0.3517488
	speed: 0.0137s/iter; left time: 59.7398s
Epoch: 6 cost time: 15.405308723449707
Epoch: 6, Steps: 1071 | Train Loss: 0.3334523 Vali Loss: 0.5134542 Test Loss: 0.3828037
Validation loss decreased (0.513851 --> 0.513454).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.3801609
	speed: 0.3749s/iter; left time: 1568.7603s
	iters: 200, epoch: 7 | loss: 0.2952213
	speed: 0.0137s/iter; left time: 55.9070s
	iters: 300, epoch: 7 | loss: 0.3068468
	speed: 0.0136s/iter; left time: 54.0749s
	iters: 400, epoch: 7 | loss: 0.2979403
	speed: 0.0135s/iter; left time: 52.2563s
	iters: 500, epoch: 7 | loss: 0.3031926
	speed: 0.0138s/iter; left time: 52.2913s
	iters: 600, epoch: 7 | loss: 0.3436843
	speed: 0.0146s/iter; left time: 53.6439s
	iters: 700, epoch: 7 | loss: 0.2641016
	speed: 0.0120s/iter; left time: 43.1128s
	iters: 800, epoch: 7 | loss: 0.3377176
	speed: 0.0120s/iter; left time: 41.8174s
	iters: 900, epoch: 7 | loss: 0.3277585
	speed: 0.0119s/iter; left time: 40.3836s
	iters: 1000, epoch: 7 | loss: 0.4053560
	speed: 0.0119s/iter; left time: 39.2344s
Epoch: 7 cost time: 14.152063846588135
Epoch: 7, Steps: 1071 | Train Loss: 0.3329315 Vali Loss: 0.5133342 Test Loss: 0.3827320
Validation loss decreased (0.513454 --> 0.513334).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.3289038
	speed: 0.4170s/iter; left time: 1298.6841s
	iters: 200, epoch: 8 | loss: 0.3170363
	speed: 0.0147s/iter; left time: 44.3907s
	iters: 300, epoch: 8 | loss: 0.4343531
	speed: 0.0133s/iter; left time: 38.6495s
	iters: 400, epoch: 8 | loss: 0.2598513
	speed: 0.0143s/iter; left time: 40.2329s
	iters: 500, epoch: 8 | loss: 0.3782285
	speed: 0.0148s/iter; left time: 40.0507s
	iters: 600, epoch: 8 | loss: 0.2935425
	speed: 0.0163s/iter; left time: 42.5802s
	iters: 700, epoch: 8 | loss: 0.3479604
	speed: 0.0165s/iter; left time: 41.4117s
	iters: 800, epoch: 8 | loss: 0.3114605
	speed: 0.0151s/iter; left time: 36.5345s
	iters: 900, epoch: 8 | loss: 0.3433643
	speed: 0.0142s/iter; left time: 32.7467s
	iters: 1000, epoch: 8 | loss: 0.3406031
	speed: 0.0144s/iter; left time: 31.9829s
Epoch: 8 cost time: 16.016913652420044
Epoch: 8, Steps: 1071 | Train Loss: 0.3327016 Vali Loss: 0.5132412 Test Loss: 0.3826849
Validation loss decreased (0.513334 --> 0.513241).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.3443628
	speed: 0.3746s/iter; left time: 765.3107s
	iters: 200, epoch: 9 | loss: 0.2755222
	speed: 0.0159s/iter; left time: 30.9349s
	iters: 300, epoch: 9 | loss: 0.3224779
	speed: 0.0164s/iter; left time: 30.1824s
	iters: 400, epoch: 9 | loss: 0.3743891
	speed: 0.0154s/iter; left time: 26.7779s
	iters: 500, epoch: 9 | loss: 0.2775275
	speed: 0.0155s/iter; left time: 25.4470s
	iters: 600, epoch: 9 | loss: 0.3305248
	speed: 0.0168s/iter; left time: 25.9683s
	iters: 700, epoch: 9 | loss: 0.2854218
	speed: 0.0154s/iter; left time: 22.1813s
	iters: 800, epoch: 9 | loss: 0.3138520
	speed: 0.0124s/iter; left time: 16.6221s
	iters: 900, epoch: 9 | loss: 0.3169599
	speed: 0.0121s/iter; left time: 15.0897s
	iters: 1000, epoch: 9 | loss: 0.3208974
	speed: 0.0122s/iter; left time: 13.8916s
Epoch: 9 cost time: 15.808411598205566
Epoch: 9, Steps: 1071 | Train Loss: 0.3327175 Vali Loss: 0.5132257 Test Loss: 0.3826244
Validation loss decreased (0.513241 --> 0.513226).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.3180857
	speed: 0.3842s/iter; left time: 373.4514s
	iters: 200, epoch: 10 | loss: 0.3238300
	speed: 0.0143s/iter; left time: 12.4566s
	iters: 300, epoch: 10 | loss: 0.3473477
	speed: 0.0126s/iter; left time: 9.7359s
	iters: 400, epoch: 10 | loss: 0.2841164
	speed: 0.0121s/iter; left time: 8.1528s
	iters: 500, epoch: 10 | loss: 0.3575321
	speed: 0.0150s/iter; left time: 8.5744s
	iters: 600, epoch: 10 | loss: 0.3282745
	speed: 0.0162s/iter; left time: 7.6313s
	iters: 700, epoch: 10 | loss: 0.3069445
	speed: 0.0159s/iter; left time: 5.9136s
	iters: 800, epoch: 10 | loss: 0.2976517
	speed: 0.0149s/iter; left time: 4.0556s
	iters: 900, epoch: 10 | loss: 0.2969077
	speed: 0.0155s/iter; left time: 2.6603s
	iters: 1000, epoch: 10 | loss: 0.3918619
	speed: 0.0156s/iter; left time: 1.1221s
Epoch: 10 cost time: 16.096191883087158
Epoch: 10, Steps: 1071 | Train Loss: 0.3325801 Vali Loss: 0.5130920 Test Loss: 0.3826153
Validation loss decreased (0.513226 --> 0.513092).  Saving model ...
Updating learning rate to 9.765625e-08
>>>>>>>testing : ETTm1_96_192_iMamba_ETTm1_M_ft96_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 1, 192, 7) (11329, 1, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.38261547684669495, mae:0.396910160779953

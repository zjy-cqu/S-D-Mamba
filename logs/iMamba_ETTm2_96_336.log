Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_336', model='iMamba', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=3e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_336_iMamba_ETTm2_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5518917
	speed: 0.0201s/iter; left time: 212.2144s
	iters: 200, epoch: 1 | loss: 0.9437951
	speed: 0.0135s/iter; left time: 141.3605s
	iters: 300, epoch: 1 | loss: 0.2081670
	speed: 0.0129s/iter; left time: 133.8082s
	iters: 400, epoch: 1 | loss: 0.6858578
	speed: 0.0129s/iter; left time: 131.8694s
	iters: 500, epoch: 1 | loss: 0.3907105
	speed: 0.0128s/iter; left time: 130.5355s
	iters: 600, epoch: 1 | loss: 0.7620793
	speed: 0.0128s/iter; left time: 128.3289s
	iters: 700, epoch: 1 | loss: 0.3197559
	speed: 0.0122s/iter; left time: 121.2712s
	iters: 800, epoch: 1 | loss: 0.6486554
	speed: 0.0120s/iter; left time: 118.6587s
	iters: 900, epoch: 1 | loss: 0.2913429
	speed: 0.0120s/iter; left time: 117.2109s
	iters: 1000, epoch: 1 | loss: 0.3880520
	speed: 0.0120s/iter; left time: 115.7908s
Epoch: 1 cost time: 14.143442630767822
Epoch: 1, Steps: 1066 | Train Loss: 0.4782163 Vali Loss: 0.2300567 Test Loss: 0.3209275
Validation loss decreased (inf --> 0.230057).  Saving model ...
Updating learning rate to 3e-05
	iters: 100, epoch: 2 | loss: 0.2340069
	speed: 0.3960s/iter; left time: 3760.3326s
	iters: 200, epoch: 2 | loss: 0.3394570
	speed: 0.0120s/iter; left time: 112.6347s
	iters: 300, epoch: 2 | loss: 0.2435052
	speed: 0.0121s/iter; left time: 112.2435s
	iters: 400, epoch: 2 | loss: 0.6179084
	speed: 0.0122s/iter; left time: 112.4307s
	iters: 500, epoch: 2 | loss: 0.9331025
	speed: 0.0122s/iter; left time: 110.6336s
	iters: 600, epoch: 2 | loss: 0.2331570
	speed: 0.0122s/iter; left time: 109.7959s
	iters: 700, epoch: 2 | loss: 0.5275713
	speed: 0.0122s/iter; left time: 108.3497s
	iters: 800, epoch: 2 | loss: 0.5509468
	speed: 0.0121s/iter; left time: 106.4475s
	iters: 900, epoch: 2 | loss: 0.8492400
	speed: 0.0121s/iter; left time: 105.4809s
	iters: 1000, epoch: 2 | loss: 0.2818215
	speed: 0.0122s/iter; left time: 104.5993s
Epoch: 2 cost time: 13.245386838912964
Epoch: 2, Steps: 1066 | Train Loss: 0.4471620 Vali Loss: 0.2267049 Test Loss: 0.3149802
Validation loss decreased (0.230057 --> 0.226705).  Saving model ...
Updating learning rate to 1.5e-05
	iters: 100, epoch: 3 | loss: 0.6822422
	speed: 0.3492s/iter; left time: 2943.7946s
	iters: 200, epoch: 3 | loss: 0.3841812
	speed: 0.0129s/iter; left time: 107.3365s
	iters: 300, epoch: 3 | loss: 0.4801959
	speed: 0.0165s/iter; left time: 135.4096s
	iters: 400, epoch: 3 | loss: 1.0146476
	speed: 0.0144s/iter; left time: 117.2083s
	iters: 500, epoch: 3 | loss: 0.3433027
	speed: 0.0140s/iter; left time: 112.3359s
	iters: 600, epoch: 3 | loss: 0.7773286
	speed: 0.0120s/iter; left time: 94.8063s
	iters: 700, epoch: 3 | loss: 0.5047159
	speed: 0.0119s/iter; left time: 93.4142s
	iters: 800, epoch: 3 | loss: 0.1923737
	speed: 0.0119s/iter; left time: 92.1898s
	iters: 900, epoch: 3 | loss: 0.4696868
	speed: 0.0119s/iter; left time: 91.1481s
	iters: 1000, epoch: 3 | loss: 0.4781198
	speed: 0.0123s/iter; left time: 92.8445s
Epoch: 3 cost time: 14.110849857330322
Epoch: 3, Steps: 1066 | Train Loss: 0.4300829 Vali Loss: 0.2290777 Test Loss: 0.3153809
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.5e-06
	iters: 100, epoch: 4 | loss: 0.3629101
	speed: 0.3649s/iter; left time: 2686.4472s
	iters: 200, epoch: 4 | loss: 0.2942487
	speed: 0.0141s/iter; left time: 102.1297s
	iters: 300, epoch: 4 | loss: 0.4548796
	speed: 0.0119s/iter; left time: 85.4445s
	iters: 400, epoch: 4 | loss: 0.4639336
	speed: 0.0113s/iter; left time: 80.0552s
	iters: 500, epoch: 4 | loss: 0.2841237
	speed: 0.0106s/iter; left time: 73.4773s
	iters: 600, epoch: 4 | loss: 0.3168028
	speed: 0.0113s/iter; left time: 77.7990s
	iters: 700, epoch: 4 | loss: 0.2889467
	speed: 0.0129s/iter; left time: 87.2258s
	iters: 800, epoch: 4 | loss: 0.4542046
	speed: 0.0115s/iter; left time: 76.6193s
	iters: 900, epoch: 4 | loss: 0.3106389
	speed: 0.0108s/iter; left time: 70.9389s
	iters: 1000, epoch: 4 | loss: 0.7492414
	speed: 0.0108s/iter; left time: 69.8297s
Epoch: 4 cost time: 12.706618785858154
Epoch: 4, Steps: 1066 | Train Loss: 0.4234720 Vali Loss: 0.2301071 Test Loss: 0.3159357
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.75e-06
	iters: 100, epoch: 5 | loss: 0.7251258
	speed: 0.4034s/iter; left time: 2540.0597s
	iters: 200, epoch: 5 | loss: 0.4143018
	speed: 0.0128s/iter; left time: 79.5656s
	iters: 300, epoch: 5 | loss: 0.2228193
	speed: 0.0128s/iter; left time: 77.8966s
	iters: 400, epoch: 5 | loss: 0.3178186
	speed: 0.0126s/iter; left time: 75.2786s
	iters: 500, epoch: 5 | loss: 0.3168503
	speed: 0.0121s/iter; left time: 71.5639s
	iters: 600, epoch: 5 | loss: 0.3890696
	speed: 0.0120s/iter; left time: 69.3529s
	iters: 700, epoch: 5 | loss: 0.4980676
	speed: 0.0120s/iter; left time: 68.1989s
	iters: 800, epoch: 5 | loss: 0.4663442
	speed: 0.0120s/iter; left time: 67.2247s
	iters: 900, epoch: 5 | loss: 0.2452037
	speed: 0.0120s/iter; left time: 65.8427s
	iters: 1000, epoch: 5 | loss: 0.5678272
	speed: 0.0120s/iter; left time: 64.6416s
Epoch: 5 cost time: 13.285615921020508
Epoch: 5, Steps: 1066 | Train Loss: 0.4201596 Vali Loss: 0.2310823 Test Loss: 0.3164434
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_336_iMamba_ETTm2_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.31498026847839355, mae:0.3513045608997345

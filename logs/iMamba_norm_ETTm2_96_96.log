Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_96', model='iMamba', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, enc_in=7, dec_in=7, c_out=7, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_96_iMamba_ETTm2_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3409038
	speed: 0.0276s/iter; left time: 293.7714s
	iters: 200, epoch: 1 | loss: 0.1994670
	speed: 0.0204s/iter; left time: 214.5631s
	iters: 300, epoch: 1 | loss: 0.3594349
	speed: 0.0204s/iter; left time: 212.5799s
	iters: 400, epoch: 1 | loss: 0.2459326
	speed: 0.0208s/iter; left time: 215.4256s
	iters: 500, epoch: 1 | loss: 0.5097457
	speed: 0.0209s/iter; left time: 213.5558s
	iters: 600, epoch: 1 | loss: 0.2608928
	speed: 0.0214s/iter; left time: 216.7201s
	iters: 700, epoch: 1 | loss: 0.2524587
	speed: 0.0201s/iter; left time: 202.2843s
	iters: 800, epoch: 1 | loss: 0.1264500
	speed: 0.0206s/iter; left time: 205.1153s
	iters: 900, epoch: 1 | loss: 0.2669654
	speed: 0.0202s/iter; left time: 198.4523s
	iters: 1000, epoch: 1 | loss: 0.2570217
	speed: 0.0196s/iter; left time: 190.9128s
Epoch: 1 cost time: 22.689071655273438
Epoch: 1, Steps: 1074 | Train Loss: 0.2538992 Vali Loss: 0.1349051 Test Loss: 0.1859809
Validation loss decreased (inf --> 0.134905).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.1569465
	speed: 1.5670s/iter; left time: 14991.0235s
	iters: 200, epoch: 2 | loss: 0.1452559
	speed: 0.0220s/iter; left time: 208.5194s
	iters: 300, epoch: 2 | loss: 0.1341431
	speed: 0.0220s/iter; left time: 205.8925s
	iters: 400, epoch: 2 | loss: 0.5487193
	speed: 0.0217s/iter; left time: 200.7475s
	iters: 500, epoch: 2 | loss: 0.6774352
	speed: 0.0221s/iter; left time: 202.8910s
	iters: 600, epoch: 2 | loss: 0.1003823
	speed: 0.0214s/iter; left time: 194.4019s
	iters: 700, epoch: 2 | loss: 0.2262501
	speed: 0.0221s/iter; left time: 197.9978s
	iters: 800, epoch: 2 | loss: 0.1820826
	speed: 0.0220s/iter; left time: 194.9543s
	iters: 900, epoch: 2 | loss: 0.1804835
	speed: 0.0217s/iter; left time: 190.3801s
	iters: 1000, epoch: 2 | loss: 0.1273207
	speed: 0.0216s/iter; left time: 187.3317s
Epoch: 2 cost time: 23.732855319976807
Epoch: 2, Steps: 1074 | Train Loss: 0.2188519 Vali Loss: 0.1354645 Test Loss: 0.1865536
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.1481778
	speed: 1.5742s/iter; left time: 13369.5940s
	iters: 200, epoch: 3 | loss: 0.1581136
	speed: 0.0210s/iter; left time: 175.8408s
	iters: 300, epoch: 3 | loss: 0.1764667
	speed: 0.0201s/iter; left time: 167.0904s
	iters: 400, epoch: 3 | loss: 0.1227700
	speed: 0.0170s/iter; left time: 139.0761s
	iters: 500, epoch: 3 | loss: 0.2055303
	speed: 0.0161s/iter; left time: 130.4096s
	iters: 600, epoch: 3 | loss: 0.1439555
	speed: 0.0161s/iter; left time: 128.7809s
	iters: 700, epoch: 3 | loss: 0.2534383
	speed: 0.0182s/iter; left time: 143.3460s
	iters: 800, epoch: 3 | loss: 0.1314344
	speed: 0.0205s/iter; left time: 159.4211s
	iters: 900, epoch: 3 | loss: 0.5500658
	speed: 0.0206s/iter; left time: 158.4370s
	iters: 1000, epoch: 3 | loss: 0.3079701
	speed: 0.0189s/iter; left time: 143.2913s
Epoch: 3 cost time: 20.53095245361328
Epoch: 3, Steps: 1074 | Train Loss: 0.2071364 Vali Loss: 0.1343326 Test Loss: 0.1863287
Validation loss decreased (0.134905 --> 0.134333).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.2810776
	speed: 1.5771s/iter; left time: 11700.3239s
	iters: 200, epoch: 4 | loss: 0.3127878
	speed: 0.0199s/iter; left time: 145.7292s
	iters: 300, epoch: 4 | loss: 0.4017384
	speed: 0.0197s/iter; left time: 142.4834s
	iters: 400, epoch: 4 | loss: 0.2265378
	speed: 0.0195s/iter; left time: 139.0980s
	iters: 500, epoch: 4 | loss: 0.1778803
	speed: 0.0199s/iter; left time: 139.4284s
	iters: 600, epoch: 4 | loss: 0.1519574
	speed: 0.0198s/iter; left time: 136.7453s
	iters: 700, epoch: 4 | loss: 0.0920666
	speed: 0.0195s/iter; left time: 132.8942s
	iters: 800, epoch: 4 | loss: 0.2199347
	speed: 0.0201s/iter; left time: 135.0943s
	iters: 900, epoch: 4 | loss: 0.1226984
	speed: 0.0210s/iter; left time: 139.2812s
	iters: 1000, epoch: 4 | loss: 0.1592483
	speed: 0.0208s/iter; left time: 135.7304s
Epoch: 4 cost time: 21.825411796569824
Epoch: 4, Steps: 1074 | Train Loss: 0.2029782 Vali Loss: 0.1340348 Test Loss: 0.1858389
Validation loss decreased (0.134333 --> 0.134035).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.2231311
	speed: 1.5688s/iter; left time: 9954.3187s
	iters: 200, epoch: 5 | loss: 0.1969342
	speed: 0.0199s/iter; left time: 124.4827s
	iters: 300, epoch: 5 | loss: 0.1147188
	speed: 0.0200s/iter; left time: 122.6574s
	iters: 400, epoch: 5 | loss: 0.1525474
	speed: 0.0196s/iter; left time: 118.2862s
	iters: 500, epoch: 5 | loss: 0.2847894
	speed: 0.0161s/iter; left time: 95.7847s
	iters: 600, epoch: 5 | loss: 0.2965366
	speed: 0.0174s/iter; left time: 101.6597s
	iters: 700, epoch: 5 | loss: 0.2195666
	speed: 0.0200s/iter; left time: 115.1028s
	iters: 800, epoch: 5 | loss: 0.1591832
	speed: 0.0185s/iter; left time: 104.3165s
	iters: 900, epoch: 5 | loss: 0.1906823
	speed: 0.0161s/iter; left time: 89.3228s
	iters: 1000, epoch: 5 | loss: 0.5348291
	speed: 0.0161s/iter; left time: 87.8556s
Epoch: 5 cost time: 19.798608541488647
Epoch: 5, Steps: 1074 | Train Loss: 0.2010487 Vali Loss: 0.1338537 Test Loss: 0.1858819
Validation loss decreased (0.134035 --> 0.133854).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 6 | loss: 0.4241363
	speed: 1.5805s/iter; left time: 8330.9460s
	iters: 200, epoch: 6 | loss: 0.1564958
	speed: 0.0208s/iter; left time: 107.3087s
	iters: 300, epoch: 6 | loss: 0.4489949
	speed: 0.0211s/iter; left time: 106.9616s
	iters: 400, epoch: 6 | loss: 0.4052711
	speed: 0.0210s/iter; left time: 104.4758s
	iters: 500, epoch: 6 | loss: 0.1781519
	speed: 0.0206s/iter; left time: 100.2246s
	iters: 600, epoch: 6 | loss: 0.1163132
	speed: 0.0206s/iter; left time: 98.0597s
	iters: 700, epoch: 6 | loss: 0.1397467
	speed: 0.0207s/iter; left time: 96.4617s
	iters: 800, epoch: 6 | loss: 0.1831418
	speed: 0.0177s/iter; left time: 80.9023s
	iters: 900, epoch: 6 | loss: 0.1678545
	speed: 0.0179s/iter; left time: 79.8366s
	iters: 1000, epoch: 6 | loss: 0.2536222
	speed: 0.0198s/iter; left time: 86.3656s
Epoch: 6 cost time: 21.90043306350708
Epoch: 6, Steps: 1074 | Train Loss: 0.2001588 Vali Loss: 0.1336879 Test Loss: 0.1856759
Validation loss decreased (0.133854 --> 0.133688).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 7 | loss: 0.1611401
	speed: 1.5496s/iter; left time: 6503.6153s
	iters: 200, epoch: 7 | loss: 0.3329126
	speed: 0.0208s/iter; left time: 85.3640s
	iters: 300, epoch: 7 | loss: 0.4744124
	speed: 0.0190s/iter; left time: 76.0112s
	iters: 400, epoch: 7 | loss: 0.1437944
	speed: 0.0189s/iter; left time: 73.5289s
	iters: 500, epoch: 7 | loss: 0.1346109
	speed: 0.0188s/iter; left time: 71.2609s
	iters: 600, epoch: 7 | loss: 0.1381212
	speed: 0.0199s/iter; left time: 73.6149s
	iters: 700, epoch: 7 | loss: 0.2056388
	speed: 0.0209s/iter; left time: 75.0760s
	iters: 800, epoch: 7 | loss: 0.1553799
	speed: 0.0208s/iter; left time: 72.6504s
	iters: 900, epoch: 7 | loss: 0.1524162
	speed: 0.0211s/iter; left time: 71.8217s
	iters: 1000, epoch: 7 | loss: 0.1190798
	speed: 0.0210s/iter; left time: 69.0965s
Epoch: 7 cost time: 21.95435905456543
Epoch: 7, Steps: 1074 | Train Loss: 0.1997100 Vali Loss: 0.1337076 Test Loss: 0.1855872
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 8 | loss: 0.1267237
	speed: 1.5645s/iter; left time: 4886.0430s
	iters: 200, epoch: 8 | loss: 0.1247111
	speed: 0.0201s/iter; left time: 60.7920s
	iters: 300, epoch: 8 | loss: 0.1433148
	speed: 0.0203s/iter; left time: 59.4315s
	iters: 400, epoch: 8 | loss: 0.1972322
	speed: 0.0204s/iter; left time: 57.6348s
	iters: 500, epoch: 8 | loss: 0.2084348
	speed: 0.0203s/iter; left time: 55.3513s
	iters: 600, epoch: 8 | loss: 0.1074832
	speed: 0.0200s/iter; left time: 52.3501s
	iters: 700, epoch: 8 | loss: 0.0975232
	speed: 0.0203s/iter; left time: 51.2289s
	iters: 800, epoch: 8 | loss: 0.2955260
	speed: 0.0201s/iter; left time: 48.7209s
	iters: 900, epoch: 8 | loss: 0.1258142
	speed: 0.0198s/iter; left time: 46.0833s
	iters: 1000, epoch: 8 | loss: 0.0944369
	speed: 0.0197s/iter; left time: 43.7585s
Epoch: 8 cost time: 21.767157554626465
Epoch: 8, Steps: 1074 | Train Loss: 0.1994567 Vali Loss: 0.1336757 Test Loss: 0.1855400
Validation loss decreased (0.133688 --> 0.133676).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 9 | loss: 0.1035902
	speed: 1.5509s/iter; left time: 3177.7494s
	iters: 200, epoch: 9 | loss: 0.1351548
	speed: 0.0214s/iter; left time: 41.6306s
	iters: 300, epoch: 9 | loss: 0.1944723
	speed: 0.0209s/iter; left time: 38.7243s
	iters: 400, epoch: 9 | loss: 0.2854434
	speed: 0.0207s/iter; left time: 36.1219s
	iters: 500, epoch: 9 | loss: 0.2226418
	speed: 0.0200s/iter; left time: 32.9917s
	iters: 600, epoch: 9 | loss: 0.1363784
	speed: 0.0200s/iter; left time: 31.0212s
	iters: 700, epoch: 9 | loss: 0.1717304
	speed: 0.0198s/iter; left time: 28.6260s
	iters: 800, epoch: 9 | loss: 0.2036645
	speed: 0.0199s/iter; left time: 26.8512s
	iters: 900, epoch: 9 | loss: 0.1681799
	speed: 0.0200s/iter; left time: 24.9537s
	iters: 1000, epoch: 9 | loss: 0.1702121
	speed: 0.0201s/iter; left time: 23.0404s
Epoch: 9 cost time: 22.105658054351807
Epoch: 9, Steps: 1074 | Train Loss: 0.1993867 Vali Loss: 0.1336679 Test Loss: 0.1855324
Validation loss decreased (0.133676 --> 0.133668).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 10 | loss: 0.1058192
	speed: 1.5504s/iter; left time: 1511.6382s
	iters: 200, epoch: 10 | loss: 0.1438708
	speed: 0.0189s/iter; left time: 16.5741s
	iters: 300, epoch: 10 | loss: 0.2812567
	speed: 0.0198s/iter; left time: 15.3549s
	iters: 400, epoch: 10 | loss: 0.1775931
	speed: 0.0205s/iter; left time: 13.8044s
	iters: 500, epoch: 10 | loss: 0.4579284
	speed: 0.0205s/iter; left time: 11.8000s
	iters: 600, epoch: 10 | loss: 0.1526926
	speed: 0.0211s/iter; left time: 10.0370s
	iters: 700, epoch: 10 | loss: 0.0818453
	speed: 0.0208s/iter; left time: 7.7834s
	iters: 800, epoch: 10 | loss: 0.1686753
	speed: 0.0209s/iter; left time: 5.7381s
	iters: 900, epoch: 10 | loss: 0.1590042
	speed: 0.0206s/iter; left time: 3.6128s
	iters: 1000, epoch: 10 | loss: 0.3615663
	speed: 0.0205s/iter; left time: 1.5410s
Epoch: 10 cost time: 22.156126499176025
Epoch: 10, Steps: 1074 | Train Loss: 0.1992739 Vali Loss: 0.1336519 Test Loss: 0.1855329
Validation loss decreased (0.133668 --> 0.133652).  Saving model ...
Updating learning rate to 9.765625e-08
>>>>>>>testing : ETTm2_96_96_iMamba_ETTm2_M_ft96_sl48_ll96_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.18553288280963898, mae:0.26600441336631775

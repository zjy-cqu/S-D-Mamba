Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_720', model='iMamba', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=5e-05, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0, d_state=2)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_720_iMamba_ETTm2_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5420038
	speed: 0.0559s/iter; left time: 583.6548s
	iters: 200, epoch: 1 | loss: 0.8128619
	speed: 0.0452s/iter; left time: 467.2263s
	iters: 300, epoch: 1 | loss: 0.5717206
	speed: 0.0458s/iter; left time: 468.7579s
	iters: 400, epoch: 1 | loss: 0.5640785
	speed: 0.0456s/iter; left time: 462.2527s
	iters: 500, epoch: 1 | loss: 0.7499610
	speed: 0.0450s/iter; left time: 451.8544s
	iters: 600, epoch: 1 | loss: 1.1994557
	speed: 0.0448s/iter; left time: 445.4770s
	iters: 700, epoch: 1 | loss: 1.3282094
	speed: 0.0459s/iter; left time: 451.3842s
	iters: 800, epoch: 1 | loss: 0.7212750
	speed: 0.0461s/iter; left time: 448.9269s
	iters: 900, epoch: 1 | loss: 0.9313533
	speed: 0.0476s/iter; left time: 458.8680s
	iters: 1000, epoch: 1 | loss: 0.4389904
	speed: 0.0455s/iter; left time: 433.7469s
Epoch: 1 cost time: 49.195921659469604
Epoch: 1, Steps: 1054 | Train Loss: 0.6139340 Vali Loss: 0.2978641 Test Loss: 0.4153502
Validation loss decreased (inf --> 0.297864).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 2 | loss: 0.6189329
	speed: 2.0127s/iter; left time: 18892.8648s
	iters: 200, epoch: 2 | loss: 0.4544411
	speed: 0.0485s/iter; left time: 450.2071s
	iters: 300, epoch: 2 | loss: 0.4760269
	speed: 0.0477s/iter; left time: 438.1465s
	iters: 400, epoch: 2 | loss: 0.2436197
	speed: 0.0537s/iter; left time: 487.5447s
	iters: 500, epoch: 2 | loss: 0.4458244
	speed: 0.0482s/iter; left time: 432.7927s
	iters: 600, epoch: 2 | loss: 0.4833747
	speed: 0.0479s/iter; left time: 426.0700s
	iters: 700, epoch: 2 | loss: 0.5805110
	speed: 0.0467s/iter; left time: 410.5263s
	iters: 800, epoch: 2 | loss: 0.7584448
	speed: 0.0474s/iter; left time: 411.4043s
	iters: 900, epoch: 2 | loss: 0.4680493
	speed: 0.0489s/iter; left time: 420.3094s
	iters: 1000, epoch: 2 | loss: 0.8179300
	speed: 0.0487s/iter; left time: 413.2232s
Epoch: 2 cost time: 52.13115739822388
Epoch: 2, Steps: 1054 | Train Loss: 0.5807453 Vali Loss: 0.2961641 Test Loss: 0.4099430
Validation loss decreased (0.297864 --> 0.296164).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 3 | loss: 0.7143092
	speed: 2.0365s/iter; left time: 16969.9445s
	iters: 200, epoch: 3 | loss: 0.3541722
	speed: 0.0501s/iter; left time: 412.8426s
	iters: 300, epoch: 3 | loss: 0.2694388
	speed: 0.0477s/iter; left time: 387.7211s
	iters: 400, epoch: 3 | loss: 0.5086855
	speed: 0.0455s/iter; left time: 365.4170s
	iters: 500, epoch: 3 | loss: 0.3424773
	speed: 0.0469s/iter; left time: 372.4290s
	iters: 600, epoch: 3 | loss: 0.9310657
	speed: 0.0471s/iter; left time: 368.6159s
	iters: 700, epoch: 3 | loss: 0.3001110
	speed: 0.0480s/iter; left time: 371.5614s
	iters: 800, epoch: 3 | loss: 0.5806324
	speed: 0.0464s/iter; left time: 353.8117s
	iters: 900, epoch: 3 | loss: 0.3893175
	speed: 0.0433s/iter; left time: 326.5346s
	iters: 1000, epoch: 3 | loss: 0.8644149
	speed: 0.0450s/iter; left time: 334.3157s
Epoch: 3 cost time: 50.182140827178955
Epoch: 3, Steps: 1054 | Train Loss: 0.5630859 Vali Loss: 0.2975414 Test Loss: 0.4089608
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 4 | loss: 0.4074396
	speed: 2.0238s/iter; left time: 14731.4930s
	iters: 200, epoch: 4 | loss: 0.8027002
	speed: 0.0451s/iter; left time: 323.9358s
	iters: 300, epoch: 4 | loss: 0.4561606
	speed: 0.0458s/iter; left time: 324.4895s
	iters: 400, epoch: 4 | loss: 0.5970441
	speed: 0.0467s/iter; left time: 325.7715s
	iters: 500, epoch: 4 | loss: 0.6687176
	speed: 0.0531s/iter; left time: 365.1582s
	iters: 600, epoch: 4 | loss: 0.6102502
	speed: 0.0469s/iter; left time: 318.2186s
	iters: 700, epoch: 4 | loss: 0.3491220
	speed: 0.0453s/iter; left time: 302.6152s
	iters: 800, epoch: 4 | loss: 0.7652082
	speed: 0.0430s/iter; left time: 283.1944s
	iters: 900, epoch: 4 | loss: 0.9274757
	speed: 0.0443s/iter; left time: 286.9405s
	iters: 1000, epoch: 4 | loss: 0.3459964
	speed: 0.0450s/iter; left time: 286.8181s
Epoch: 4 cost time: 48.66264462471008
Epoch: 4, Steps: 1054 | Train Loss: 0.5560620 Vali Loss: 0.2975135 Test Loss: 0.4086295
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 5 | loss: 0.6102527
	speed: 2.0535s/iter; left time: 12782.8819s
	iters: 200, epoch: 5 | loss: 0.9914956
	speed: 0.0471s/iter; left time: 288.7344s
	iters: 300, epoch: 5 | loss: 0.6994178
	speed: 0.0468s/iter; left time: 281.8291s
	iters: 400, epoch: 5 | loss: 0.8021798
	speed: 0.0475s/iter; left time: 281.6567s
	iters: 500, epoch: 5 | loss: 0.6141360
	speed: 0.0485s/iter; left time: 282.5916s
	iters: 600, epoch: 5 | loss: 0.3956183
	speed: 0.0537s/iter; left time: 307.3608s
	iters: 700, epoch: 5 | loss: 0.5646203
	speed: 0.0482s/iter; left time: 271.2499s
	iters: 800, epoch: 5 | loss: 1.0666891
	speed: 0.0437s/iter; left time: 241.5917s
	iters: 900, epoch: 5 | loss: 0.9572780
	speed: 0.0467s/iter; left time: 253.3797s
	iters: 1000, epoch: 5 | loss: 0.3704860
	speed: 0.0475s/iter; left time: 253.0240s
Epoch: 5 cost time: 50.75381803512573
Epoch: 5, Steps: 1054 | Train Loss: 0.5527938 Vali Loss: 0.2988749 Test Loss: 0.4088645
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_720_iMamba_ETTm2_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40994301438331604, mae:0.404674768447876
